import{j as e}from"./index-tBdcIxzk.js";import{r}from"./vendor-D_DxLZN2.js";import{L as s}from"./router-BPhEMSNK.js";import{authService as a}from"./auth-CFgD0Kdo.js";import{B as t}from"./Button-q_HxaLrT.js";import{C as n}from"./Card-CCr5q94u.js";import"./supabase-BMSNwJ-5.js";import"./supabase-DCVaQTjR.js";const i=()=>{const[i,l]=r.useState("key"),[o,d]=r.useState(""),[c,m]=r.useState(""),[u,x]=r.useState({name:"",email:"",password:"",confirmPassword:""}),[h,g]=r.useState(!1),[p,f]=r.useState(""),[b,y]=r.useState(""),j=e=>{e.preventDefault(),"DCODE_RAMESH_WITH_TEAMS"===o?(l("form"),m("")):m("Invalid admin key. Access denied.")},N=e=>{x({...u,[e.target.name]:e.target.value})};return"key"===i?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(n,{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("i",{className:"ri-shield-keyhole-line text-2xl text-red-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Access Required"}),e.jsx("p",{className:"text-gray-600",children:"Enter the admin creation key to proceed"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[c&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg text-sm",children:[e.jsx("i",{className:"ri-error-warning-line mr-2"}),c]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"adminKey",className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Creation Key"}),e.jsx("input",{id:"adminKey",name:"adminKey",type:"password",value:o,onChange:e=>d(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter admin creation key",required:!0})]}),e.jsxs(t,{type:"submit",fullWidth:!0,className:"py-3 text-base font-semibold",children:[e.jsx("i",{className:"ri-key-line mr-2"}),"Verify Key"]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Don't have the key?"," ",e.jsx(s,{to:"/auth/signin",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in instead"})]})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsx("div",{className:"text-center",children:e.jsx(s,{to:"/",className:"text-gray-500 hover:text-gray-700 text-sm",children:"← Back to Home"})})})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(n,{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("i",{className:"ri-user-settings-line text-2xl text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Admin Account"}),e.jsx("p",{className:"text-gray-600",children:"Create the first admin user for your system"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g(!0),f(""),y(""),u.password!==u.confirmPassword)return f("Passwords do not match"),void g(!1);if(u.password.length<8)return f("Password must be at least 8 characters long"),void g(!1);try{console.log("Testing SMTP configuration..."),console.log("Email:",u.email);const e=await a.signUp(u.email,u.password,u.name);console.log("Sign up result:",e),e.needsVerification?y("Admin account created! However, email verification is still required. Please check your email and verify the account."):e.user&&y("Admin account created successfully! You can now sign in.")}catch(r){console.error("Admin creation error:",r),console.error("Error details:",r),f(r instanceof Error?r.message:"An error occurred during admin creation")}finally{g(!1)}},className:"space-y-6",children:[p&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg text-sm",children:[e.jsx("i",{className:"ri-error-warning-line mr-2"}),p]}),b&&e.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg text-sm",children:[e.jsx("i",{className:"ri-check-circle-line mr-2"}),b]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{id:"name",name:"name",type:"text",value:u.name,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter admin name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{id:"email",name:"email",type:"email",value:u.email,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"admin@dcode.ai",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",value:u.password,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter password",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:u.confirmPassword,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Confirm password",required:!0})]}),e.jsx(t,{type:"submit",disabled:h,fullWidth:!0,className:"py-3 text-base font-semibold",children:h?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Creating Admin..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-user-settings-line mr-2"}),"Create Admin Account"]})})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",e.jsx(s,{to:"/auth/signin",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in here"})]})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>l("key"),className:"text-gray-500 hover:text-gray-700 text-sm",children:"← Back to Key Verification"})})})]})})};export{i as default};
