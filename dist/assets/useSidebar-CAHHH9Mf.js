import{j as e,u as t,a as r}from"./index-BaWXG3YY.js";import{r as s}from"./vendor-D_DxLZN2.js";import{a,L as n}from"./router-BbFJyaaj.js";import{C as i}from"./Card-CQri447u.js";function l({isOpen:t,onClose:r,children:a,title:n}){return s.useEffect(()=>(document.body.style.overflowY=t?"hidden":"",()=>{document.body.style.overflowY=""}),[t]),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden touch-pan-y overflow-x-hidden",onClick:r}),e.jsxs("div",{className:"fixed left-0 top-0 h-full w-80 max-w-[85vw] bg-white shadow-xl z-50 transform transition-transform duration-300 ease-in-out lg:hidden overflow-x-hidden touch-pan-y "+(t?"translate-x-0":"-translate-x-full"),children:[n&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg cursor-pointer min-h-[44px] min-w-[44px] flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-xl text-gray-600"})})]}),e.jsx("div",{className:"overflow-y-auto h-full pb-4",children:a})]})]}):null}function o({user:i}){const[l,o]=s.useState(!1),[c,d]=s.useState(!1),m=s.useRef(null),u=a(),{theme:x,setTheme:f}=t();s.useEffect(()=>{const e=()=>{d(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s.useEffect(()=>{"mentor"===i.role&&"dark"===x&&(f("light"),console.log("ðŸŽ¨ ProfileMenu: Forced light mode for mentor"))},[i.role,x,f]),s.useEffect(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&o(!1)};return l&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[l]),s.useEffect(()=>{const e=e=>{"Escape"===e.key&&o(!1)};return l&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[l]);const h=async()=>{try{await r.signOut(),u("/auth/signin")}catch(e){console.error("Logout failed:",e)}},p=e=>e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),b=[{label:"View Profile",icon:"ri-user-line",path:(()=>{switch(i.role){case"student":return"/student/profile";case"mentor":return"/mentor/profile";case"admin":return"/admin/profile";default:return"/profile"}})()},{label:"Settings",icon:"ri-settings-line",path:(()=>{switch(i.role){case"student":return"/student/settings";case"mentor":return"/mentor/settings";case"admin":return"/admin/settings";default:return"/settings"}})()},{label:"My Wishlist",icon:"ri-heart-line",path:(()=>{switch(i.role){case"student":return"/student/wishlist";case"mentor":return"/mentor/wishlist";default:return"/wishlist"}})()},{label:"Notifications",icon:"ri-notification-line",path:"#"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",ref:m,children:[e.jsx("button",{onClick:()=>o(!l),className:"profile-avatar","aria-label":"Open profile menu",children:i.avatar?e.jsx("img",{src:i.avatar,alt:i.name,className:"w-full h-full object-cover rounded-full"}):p(i.name)}),l&&!c&&e.jsxs("div",{className:"profile-menu animate-slide-down",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:i.name}),e.jsx("p",{className:"text-xs text-gray-500",children:i.email}),e.jsx("span",{className:"inline-block px-2 py-1 text-xs font-medium text-white bg-gradient-to-r from-purple-600 to-orange-500 rounded-full mt-1 capitalize",children:i.role})]}),e.jsxs("div",{className:"py-2",children:[b.map((t,r)=>e.jsxs(n,{to:t.path,className:"profile-menu-item",onClick:()=>o(!1),children:[e.jsx("div",{className:"profile-menu-icon",children:e.jsx("i",{className:t.icon})}),t.label]},r)),e.jsxs("button",{onClick:h,className:"profile-menu-item",children:[e.jsx("div",{className:"profile-menu-icon",children:e.jsx("i",{className:"ri-logout-circle-line"})}),"Logout"]})]})]})]}),c&&e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>o(!1)}),e.jsxs("div",{className:"profile-menu-mobile "+(l?"open":""),children:[e.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full mx-auto mb-4"}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"profile-avatar mx-auto mb-3",children:i.avatar?e.jsx("img",{src:i.avatar,alt:i.name,className:"w-full h-full object-cover rounded-full"}):p(i.name)}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:i.name}),e.jsx("p",{className:"text-sm text-gray-500",children:i.email}),e.jsx("span",{className:"inline-block px-3 py-1 text-sm font-medium text-white bg-gradient-to-r from-purple-600 to-orange-500 rounded-full mt-2 capitalize",children:i.role})]}),e.jsxs("div",{className:"space-y-1",children:[b.map((t,r)=>e.jsxs(n,{to:t.path,className:"profile-menu-mobile-item",onClick:()=>o(!1),children:[e.jsx("div",{className:"profile-menu-icon",children:e.jsx("i",{className:t.icon})}),t.label]},r)),e.jsxs("button",{onClick:h,className:"profile-menu-mobile-item",children:[e.jsx("div",{className:"profile-menu-icon",children:e.jsx("i",{className:"ri-logout-circle-line"})}),"Logout"]})]})]})]})]})}const c=({content:t,children:r,position:a="right",delay:n=500})=>{const[i,l]=s.useState(!1),[o,c]=s.useState(!1),d=s.useRef();s.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]);return e.jsxs("div",{className:"relative inline-block",onMouseEnter:()=>{d.current=setTimeout(()=>{l(!0),setTimeout(()=>c(!0),10)},n)},onMouseLeave:()=>{d.current&&clearTimeout(d.current),c(!1),setTimeout(()=>l(!1),150)},children:[r,i&&e.jsx("div",{className:`absolute z-50 ${(()=>{switch(a){case"top":return"bottom-full left-1/2 transform -translate-x-1/2 mb-2";case"bottom":return"top-full left-1/2 transform -translate-x-1/2 mt-2";case"left":return"right-full top-1/2 transform -translate-y-1/2 mr-2";default:return"left-full top-1/2 transform -translate-y-1/2 ml-2"}})()}`,children:e.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded py-1 px-2 whitespace-nowrap transition-opacity duration-150 "+(o?"opacity-100":"opacity-0"),children:[t,e.jsx("div",{className:`absolute w-0 h-0 border-2 ${(()=>{switch(a){case"top":return"top-full left-1/2 transform -translate-x-1/2 border-l-transparent border-r-transparent border-b-transparent border-t-gray-900";case"bottom":return"bottom-full left-1/2 transform -translate-x-1/2 border-l-transparent border-r-transparent border-t-transparent border-b-gray-900";case"left":return"left-full top-1/2 transform -translate-y-1/2 border-t-transparent border-b-transparent border-r-transparent border-l-gray-900";default:return"right-full top-1/2 transform -translate-y-1/2 border-t-transparent border-b-transparent border-l-transparent border-r-gray-900"}})()}`})]})})]})},d=({children:t})=>{const r=a(),[n,l]=s.useState(!1),[o,c]=s.useState([{id:"1",type:"achievement",title:"New Badge Earned!",message:'You earned the "Quick Learner" badge for completing 5 lessons in one day.',timestamp:"2024-01-15T10:30:00Z",read:!1,icon:"ri-medal-line",color:"yellow"},{id:"2",type:"course",title:"Course Progress",message:"You're 80% through the JavaScript Fundamentals course. Keep going!",timestamp:"2024-01-15T09:15:00Z",read:!1,icon:"ri-book-line",color:"blue"},{id:"3",type:"reminder",title:"Study Reminder",message:"Don't forget about your scheduled study session at 2:00 PM today.",timestamp:"2024-01-15T08:00:00Z",read:!0,icon:"ri-calendar-line",color:"green"},{id:"4",type:"system",title:"Platform Update",message:"New features have been added to the assessment system. Check them out!",timestamp:"2024-01-14T16:45:00Z",read:!0,icon:"ri-information-line",color:"purple"},{id:"5",type:"achievement",title:"Level Up!",message:"Congratulations! You've reached Level 3: Intermediate.",timestamp:"2024-01-14T14:20:00Z",read:!0,icon:"ri-trophy-line",color:"gold"}]),d=s.useRef(null),m=o.filter(e=>!e.read).length;s.useEffect(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const u=e=>{const t=new Date(e),r=new Date,s=Math.floor((r.getTime()-t.getTime())/36e5);if(s<1){const e=Math.floor((r.getTime()-t.getTime())/6e4);return e<1?"Just now":`${e}m ago`}if(s<24)return`${s}h ago`;return`${Math.floor(s/24)}d ago`},x=e=>{switch(e){case"yellow":case"gold":return"bg-yellow-100 text-yellow-600";case"blue":return"bg-blue-100 text-blue-600";case"green":return"bg-green-100 text-green-600";case"purple":return"bg-purple-100 text-purple-600";default:return"bg-gray-100 text-gray-600"}};return e.jsxs("div",{className:"relative",ref:d,children:[e.jsxs("div",{onClick:()=>l(!n),className:"cursor-pointer relative",children:[t,m>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs font-medium rounded-full flex items-center justify-center",children:m>9?"9+":m})]}),n&&e.jsx("div",{className:"absolute right-0 mt-2 w-96 max-w-sm z-50",children:e.jsxs(i,{className:"shadow-xl border-0 bg-theme-card-bg/95 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-theme-border",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-theme-text-primary",children:"Notifications"}),m>0&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-red-100 text-red-600 text-xs font-medium rounded-full",children:[m," new"]})]}),m>0&&e.jsx("button",{onClick:()=>{c(e=>e.map(e=>({...e,read:!0})))},className:"text-xs text-brand-primary hover:text-brand-secondary font-medium transition-colors duration-200",children:"Mark all read"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===o.length?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("i",{className:"ri-notification-off-line text-3xl text-theme-text-tertiary mb-3"}),e.jsx("p",{className:"text-theme-text-secondary",children:"No notifications yet"})]}):e.jsx("div",{className:"divide-y divide-theme-border",children:o.map(t=>e.jsx("div",{className:"p-4 hover:bg-theme-hover-bg transition-colors duration-200 "+(t.read?"":"bg-blue-50/50 dark:bg-blue-900/10"),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${x(t.color)}`,children:e.jsx("i",{className:`${t.icon} text-sm`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-theme-text-primary "+(t.read?"":"font-semibold"),children:t.title}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[!t.read&&e.jsx("button",{onClick:()=>{return e=t.id,void c(t=>t.map(t=>t.id===e?{...t,read:!0}:t));var e},className:"text-brand-primary hover:text-brand-secondary transition-colors duration-200",title:"Mark as read",children:e.jsx("i",{className:"ri-check-line text-sm"})}),e.jsx("button",{onClick:()=>{return e=t.id,void c(t=>t.filter(t=>t.id!==e));var e},className:"text-theme-text-tertiary hover:text-red-500 transition-colors duration-200",title:"Delete notification",children:e.jsx("i",{className:"ri-close-line text-sm"})})]})]}),e.jsx("p",{className:"text-sm text-theme-text-secondary mt-1 line-clamp-2",children:t.message}),e.jsx("p",{className:"text-xs text-theme-text-tertiary mt-2",children:u(t.timestamp)})]})]})},t.id))})}),o.length>0&&e.jsx("div",{className:"p-3 border-t border-theme-border",children:e.jsx("button",{onClick:()=>{l(!1),r("/student/notifications")},className:"w-full text-center text-sm text-brand-primary hover:text-brand-secondary font-medium transition-colors duration-200",children:"View all notifications"})})]})})]})},m=(e="sidebar-collapsed")=>{const[t,r]=s.useState(()=>{const t=localStorage.getItem(e);return!!t&&JSON.parse(t)});return s.useEffect(()=>{const t=t=>{t.key===e&&t.newValue&&r(JSON.parse(t.newValue))};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[e]),{isCollapsed:t,toggleSidebar:()=>{r(t=>{const r=!t;return localStorage.setItem(e,JSON.stringify(r)),r})},collapseSidebar:()=>{r(!0),localStorage.setItem(e,JSON.stringify(!0))},expandSidebar:()=>{r(!1),localStorage.setItem(e,JSON.stringify(!1))}}};export{l as M,d as N,o as P,c as T,m as u};
