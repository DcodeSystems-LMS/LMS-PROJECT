import{j as e,s,a as l}from"./index-BaWXG3YY.js";import{r}from"./vendor-D_DxLZN2.js";import{C as t}from"./Card-CQri447u.js";import{D as a}from"./dataService-M2AFkWLp.js";import{B as i}from"./Button-lmmCuxjA.js";import{a as n}from"./router-BbFJyaaj.js";import"./supabase-DnW1kxsT.js";const o=({lessonId:l,onVideoUploaded:t,onUploadProgress:a,onUploadError:i,maxFileSize:n=500,acceptedFormats:o=["video/mp4","video/webm","video/avi","video/mov"]})=>{const[d,c]=r.useState(!1),[m,u]=r.useState(!1),[x,g]=r.useState(0),[p,h]=r.useState(null),b=r.useRef(null),v=async e=>{try{u(!0),g(0),h(e);const l=(e=>e.size>1024*n*1024?`File size must be less than ${n}MB`:o.includes(e.type)?null:`File type must be one of: ${o.join(", ")}`)(e);if(l)return void(null==i||i(l));console.log("üì§ Starting video upload:",e.name);const r=setInterval(()=>{g(e=>e>=90?(clearInterval(r),e):e+10)},200),d=await(async e=>{try{const l=e.name.split(".").pop(),r=`course-videos/${Date.now()}-${Math.random().toString(36).substring(2)}.${l}`;console.log("üì§ Uploading video to Supabase storage:",r);const{data:t,error:a}=await s.storage.from("course-videos").upload(r,e,{cacheControl:"3600",upsert:!1});if(a)throw console.error("‚ùå Supabase upload error:",a),new Error(`Upload failed: ${a.message}`);console.log("‚úÖ Video uploaded successfully:",t);const{data:i}=s.storage.from("course-videos").getPublicUrl(r);if(!(null==i?void 0:i.publicUrl))throw new Error("Failed to get public URL");return i.publicUrl}catch(l){throw console.error("‚ùå Video upload error:",l),l}})(e);clearInterval(r),g(100),console.log("‚úÖ Video upload completed:",d),t(d,e),null==a||a(100)}catch(l){console.error("‚ùå Upload failed:",l),null==i||i(l instanceof Error?l.message:"Upload failed")}finally{u(!1)}},f=r.useCallback(e=>{e.preventDefault(),e.stopPropagation(),c(!0)},[]),j=r.useCallback(e=>{e.preventDefault(),e.stopPropagation(),c(!1)},[]),y=r.useCallback(e=>{e.preventDefault(),e.stopPropagation(),c(!1);const s=Array.from(e.dataTransfer.files).find(e=>o.includes(e.type));s?v(s):null==i||i("Please drop a valid video file")},[o,i]);return e.jsxs("div",{className:`\n        relative border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200\n        ${d?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 hover:border-gray-400"}\n        ${m?"pointer-events-none opacity-75":"cursor-pointer"}\n      `,onDragOver:f,onDragLeave:j,onDrop:y,onClick:()=>{var e;null==(e=b.current)||e.click()},children:[e.jsx("input",{ref:b,type:"file",accept:o.join(","),onChange:e=>{var s;const l=null==(s=e.target.files)?void 0:s[0];l&&v(l)},className:"hidden"}),m?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Uploading ",null==p?void 0:p.name,"..."]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[x,"% complete"]})]})]}):e.jsxs("div",{children:[e.jsx("i",{className:"ri-upload-cloud-line text-4xl text-gray-400 mb-4"}),e.jsxs("div",{className:"text-gray-600 dark:text-gray-300",children:[e.jsx("p",{className:"font-medium mb-2",children:d?"Drop your video file here":"Drop your video file here or click to browse"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supported formats: MP4, WebM, AVI, MOV"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Maximum file size: ",n,"MB"]})]})]}),p&&!m&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:["‚úì File selected: ",p.name]})})]})},d=()=>{const s=n(),[d,c]=r.useState(1),[m,u]=r.useState(!1),[x,g]=r.useState(""),[p,h]=r.useState(""),[b,v]=r.useState([]),[f,j]=r.useState(null),[y,N]=r.useState({title:"",description:"",category:"",level:"",price:"",coverImage:"",duration:"",difficulty:"beginner",objectives:[""],requirements:[""],tags:""}),[w,C]=r.useState([{id:1,title:"",videoType:"youtube",videoUrl:"",videoFile:null,language:"English",description:""}]),[k,U]=r.useState(null),[S,T]=r.useState([{id:1,title:"",description:"",file:null,category:"general"}]);r.useEffect(()=>{D()},[]);const D=async()=>{try{u(!0);const e=await l.getCurrentUser();if(!e)return void s("/auth/signin");j(e);const r=await a.getCourses(),t=[...new Set(r.map(e=>e.category))];v(t),console.log("‚úÖ Upload course page initialized")}catch(e){console.error("‚ùå Error initializing upload course page:",e),g("Failed to initialize page. Please refresh and try again.")}finally{u(!1)}},I=[{id:1,title:"Course Info",icon:"ri-information-line"},{id:2,title:"Lessons",icon:"ri-video-line"},{id:3,title:"Materials",icon:"ri-file-line"},{id:4,title:"Preview",icon:"ri-eye-line"}],M=[{value:"English",label:"English"},{value:"Telugu",label:"‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)"},{value:"Hindi",label:"‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)"}],L=[{value:"general",label:"General"},{value:"slides",label:"Lecture Slides"},{value:"handout",label:"Handouts"},{value:"code",label:"Code Files"},{value:"reference",label:"Reference Materials"},{value:"assignment",label:"Assignments"},{value:"solution",label:"Solutions"}],F=(e,s)=>{N(l=>({...l,[e]:s}))},$=(e,s,l)=>{C(r=>r.map(r=>r.id===e?{...r,[s]:l}:r))},P=e=>{console.error("‚ùå Video upload error:",e),g(`Video upload failed: ${e}`)},z=(e,s,l)=>{T(r=>r.map(r=>r.id===e?{...r,[s]:l}:r))},E=e=>{var s;switch(null==(s=e.split(".").pop())?void 0:s.toLowerCase()){case"pdf":return"ri-file-pdf-line";case"doc":case"docx":return"ri-file-word-line";case"ppt":case"pptx":return"ri-file-ppt-line";case"xls":case"xlsx":return"ri-file-excel-line";case"zip":case"rar":return"ri-file-zip-line";case"jpg":case"jpeg":case"png":case"gif":return"ri-image-line";case"mp4":case"avi":case"mov":return"ri-video-line";case"mp3":case"wav":return"ri-music-line";case"txt":return"ri-file-text-line";case"js":case"ts":case"html":case"css":case"py":case"java":case"cpp":case"c":return"ri-code-line";default:return"ri-file-line"}},q=e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},A=e=>/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+/.test(e),V=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Upload New Course"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create and publish a new course for students"}),x&&e.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-error-warning-line text-red-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:x})]})]})}),p&&e.jsx("div",{className:"mt-4 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-check-line text-green-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),e.jsx("div",{className:"mt-2 text-sm text-green-700",children:p})]})]})})]}),e.jsx(t,{children:e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:I.map((s,l)=>e.jsxs("div",{className:"flex items-center w-full sm:w-auto",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full "+(d>=s.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"),children:e.jsx("i",{className:s.icon})}),e.jsx("div",{className:"ml-3 flex-1 sm:flex-none",children:e.jsx("div",{className:"text-sm font-medium "+(d>=s.id?"text-blue-600":"text-gray-500"),children:s.title})}),l<I.length-1&&e.jsx("div",{className:"hidden sm:block w-16 h-1 mx-4 "+(d>s.id?"bg-blue-600":"bg-gray-200")})]},s.id))})}),e.jsxs(t,{children:[1===d&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Course Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course Title *"}),e.jsx("input",{type:"text",value:y.title,onChange:e=>F("title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter course title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{value:y.description,onChange:e=>F("description",e.target.value),rows:4,maxLength:500,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe what students will learn in this course"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[y.description.length,"/500 characters"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{value:y.category,onChange:e=>F("category",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Web Development",children:"Web Development"}),e.jsx("option",{value:"Data Science",children:"Data Science"}),e.jsx("option",{value:"Mobile Development",children:"Mobile Development"}),e.jsx("option",{value:"DevOps",children:"DevOps"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level *"}),e.jsxs("select",{value:y.level,onChange:e=>F("level",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8",children:[e.jsx("option",{value:"",children:"Select Level"}),e.jsx("option",{value:"Beginner",children:"Beginner"}),e.jsx("option",{value:"Intermediate",children:"Intermediate"}),e.jsx("option",{value:"Advanced",children:"Advanced"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (‚Çπ) *"}),e.jsx("input",{type:"number",value:y.price,onChange:e=>F("price",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"999",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cover Image URL"}),e.jsx("input",{type:"url",value:y.coverImage,onChange:e=>F("coverImage",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"}),y.coverImage&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:y.coverImage,alt:"Course cover preview",className:"w-32 h-20 object-cover rounded border",onError:e=>{e.currentTarget.style.display="none"}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (Hours)"}),e.jsx("input",{type:"number",value:y.duration,onChange:e=>F("duration",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"10",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course Objectives"}),y.objectives.map((s,l)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:s,onChange:e=>{const s=[...y.objectives];s[l]=e.target.value,N(e=>({...e,objectives:s}))},className:"flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`Objective ${l+1}`}),y.objectives.length>1&&e.jsx("button",{type:"button",onClick:()=>{const e=y.objectives.filter((e,s)=>s!==l);N(s=>({...s,objectives:e}))},className:"px-3 py-2 text-red-600 hover:text-red-700",children:e.jsx("i",{className:"ri-delete-bin-line"})})]},l)),e.jsx("button",{type:"button",onClick:()=>N(e=>({...e,objectives:[...e.objectives,""]})),className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Add Objective"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course Requirements"}),y.requirements.map((s,l)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:s,onChange:e=>{const s=[...y.requirements];s[l]=e.target.value,N(e=>({...e,requirements:s}))},className:"flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`Requirement ${l+1}`}),y.requirements.length>1&&e.jsx("button",{type:"button",onClick:()=>{const e=y.requirements.filter((e,s)=>s!==l);N(s=>({...s,requirements:e}))},className:"px-3 py-2 text-red-600 hover:text-red-700",children:e.jsx("i",{className:"ri-delete-bin-line"})})]},l)),e.jsx("button",{type:"button",onClick:()=>N(e=>({...e,requirements:[...e.requirements,""]})),className:"text-blue-600 hover:text-blue-700 text-sm",children:"+ Add Requirement"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:y.tags,onChange:e=>F("tags",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"React, JavaScript, Frontend"})]})]})]}),2===d&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-2 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Course Lessons"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Add lessons and arrange them in order"})]}),e.jsxs(i,{size:"sm",onClick:()=>{const e={id:Date.now(),title:"",videoType:"youtube",videoUrl:"",videoFile:null,language:"English",description:""};C(s=>[...s,e])},children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Add Lesson"]})]}),e.jsx("div",{className:"space-y-4",children:w.map((s,l)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg bg-white hover:shadow-sm transition-shadow",draggable:!0,onDragStart:e=>((e,s)=>{U(s),e.dataTransfer.effectAllowed="move"})(e,s.id),onDragOver:V,onDrop:e=>((e,s)=>{if(e.preventDefault(),null===k||k===s)return;const l=w.findIndex(e=>e.id===k),r=w.findIndex(e=>e.id===s),t=[...w],a=t.splice(l,1)[0];t.splice(r,0,a),C(t),U(null)})(e,s.id),children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start mb-4 space-y-2 sm:space-y-0",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-drag-move-line text-gray-400 cursor-move"}),e.jsxs("h3",{className:"font-medium text-gray-900",children:["Lesson ",l+1]})]})}),w.length>1&&e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{return e=s.id,void(1!==w.length&&window.confirm("Are you sure you want to delete this lesson?")&&C(s=>s.filter(s=>s.id!==e)));var e},className:"text-red-600 hover:text-red-700 hover:border-red-300",children:e.jsx("i",{className:"ri-delete-bin-line"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lesson Title *"}),e.jsx("input",{type:"text",value:s.title,onChange:e=>$(s.id,"title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter lesson title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),e.jsx("select",{value:s.language,onChange:e=>$(s.id,"language",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8",children:M.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Video Source *"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:`videoType-${s.id}`,value:"youtube",checked:"youtube"===s.videoType,onChange:e=>$(s.id,"videoType",e.target.value),className:"mr-2"}),e.jsx("span",{children:"YouTube URL"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:`videoType-${s.id}`,value:"upload",checked:"upload"===s.videoType,onChange:e=>$(s.id,"videoType",e.target.value),className:"mr-2"}),e.jsx("span",{children:"Upload MP4"})]})]})]}),"youtube"===s.videoType?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"YouTube URL *"}),e.jsx("input",{type:"url",value:s.videoUrl,onChange:e=>$(s.id,"videoUrl",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://www.youtube.com/watch?v=..."}),s.videoUrl&&!A(s.videoUrl)&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:"Please enter a valid YouTube URL"}),s.videoUrl&&A(s.videoUrl)&&e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"text-sm text-green-600 mb-2",children:"‚úì Valid YouTube URL"})})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Video File *"}),e.jsx(o,{lessonId:s.id,onVideoUploaded:(e,l)=>((e,s,l)=>{console.log("‚úÖ Video uploaded successfully:",{lessonId:e,videoUrl:s,videoFile:l}),C(w.map(r=>r.id===e?{...r,videoUrl:s,videoFile:l,videoType:"upload"}:r)),h(`Video uploaded successfully: ${l.name}`)})(s.id,e,l),onUploadError:P,maxFileSize:500,acceptedFormats:["video/mp4","video/webm","video/avi","video/mov"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{value:s.description,onChange:e=>$(s.id,"description",e.target.value),rows:2,maxLength:300,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of what this lesson covers"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s.description.length,"/300 characters"]})]})]})]},s.id))}),0===w.length&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ri-video-line text-4xl text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:'No lessons added yet. Click "Add Lesson" to get started.'})]})]}),3===d&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-2 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Course Materials"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Upload additional materials like slides, handouts, and code files"})]}),e.jsxs(i,{size:"sm",onClick:()=>{const e={id:Date.now(),title:"",description:"",file:null,category:"general"};T(s=>[...s,e])},children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Add Material"]})]}),S.length>0?e.jsx("div",{className:"space-y-4",children:S.map((s,l)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:l+1})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:["Material ",l+1]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload course material"})]})]}),S.length>1&&e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{return e=s.id,void(1!==S.length&&window.confirm("Are you sure you want to delete this material?")&&T(s=>s.filter(s=>s.id!==e)));var e},className:"text-red-600 hover:text-red-700 hover:border-red-300",children:e.jsx("i",{className:"ri-delete-bin-line"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Material Title *"}),e.jsx("input",{type:"text",value:s.title,onChange:e=>z(s.id,"title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., CSS Flexbox Lecture Slides"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsx("select",{value:s.category,onChange:e=>z(s.id,"category",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:L.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload File *"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.zip,.rar,.jpg,.jpeg,.png,.gif,.mp4,.avi,.mov,.mp3,.wav,.txt,.js,.ts,.html,.css,.py,.java,.cpp,.c",onChange:e=>{var l;return z(s.id,"file",(null==(l=e.target.files)?void 0:l[0])||null)},className:"hidden",id:`material-upload-${s.id}`}),e.jsx("label",{htmlFor:`material-upload-${s.id}`,className:"cursor-pointer",children:s.file?e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("i",{className:`${E(s.file.name)} text-2xl text-blue-600`}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.file.name}),e.jsx("div",{className:"text-xs text-gray-500",children:q(s.file.size)})]})]}):e.jsxs("div",{children:[e.jsx("i",{className:"ri-upload-cloud-line text-3xl sm:text-4xl text-gray-400 mb-2"}),e.jsxs("div",{className:"text-gray-600",children:["Drop your file here or ",e.jsx("span",{className:"text-blue-600",children:"click to browse"})]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Supports: PDF, DOC, PPT, XLS, ZIP, Images, Videos, Audio, Code files"}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Maximum file size: 100MB"})]})})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:e=>z(s.id,"description",e.target.value),rows:2,maxLength:300,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of this material (optional)"})]})]},s.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-file-line text-4xl text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:'No materials added yet. Click "Add Material" to get started.'})]})]}),4===d&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Course Preview"}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[y.coverImage&&e.jsx("div",{children:e.jsx("img",{src:y.coverImage,alt:y.title,className:"w-full h-48 object-cover rounded-lg shadow-sm",onError:e=>{e.currentTarget.style.display="none"}})}),e.jsxs("div",{className:y.coverImage?"lg:col-span-2":"lg:col-span-3",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:y.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:y.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-bookmark-line mr-1"}),y.category]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-signal-tower-line mr-1"}),y.level]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-money-rupee-circle-line mr-1"}),"‚Çπ",y.price]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[w.length," lesson",1!==w.length?"s":""," ‚Ä¢ Multi-language support"]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Course Content"}),e.jsx("div",{className:"space-y-3",children:w.map((s,l)=>{const r=(e=>{var s;if("youtube"===e.videoType&&A(e.videoUrl)){const l=null==(s=e.videoUrl.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/))?void 0:s[1];return l?`https://img.youtube.com/vi/${l}/hqdefault.jpg`:null}return null})(s);return e.jsxs("div",{className:"flex items-center p-4 bg-white border border-gray-200 rounded-lg hover:shadow-sm transition-shadow",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-blue-600 font-medium text-sm",children:l+1})}),r&&e.jsx("div",{className:"w-16 h-12 mr-4 flex-shrink-0",children:e.jsx("img",{src:r,alt:s.title,className:"w-full h-full object-cover rounded"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-1 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 truncate",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 truncate",children:s.description})]}),e.jsxs("div",{className:"flex items-center space-x-3 flex-shrink-0",children:[e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx("i",{className:"ri-global-line mr-1"}),s.language]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx("i",{className:("youtube"===s.videoType?"ri-youtube-line":"ri-file-video-line")+" mr-1"}),"youtube"===s.videoType?"YouTube":"Upload"]})]})]})})]},s.id)})})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-translate-line text-green-600 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-900 mb-1",children:"Multi-language Course"}),e.jsx("p",{className:"text-green-800 text-sm mb-2",children:"Your course includes lessons in multiple languages:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(new Set(w.map(e=>e.language))).map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[s," (",w.filter(e=>e.language===s).length," lesson",1!==w.filter(e=>e.language===s).length?"s":"",")"]},s))})]})]})}),S.length>0&&S.some(e=>e.title.trim())&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Course Materials"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:S.filter(e=>e.title.trim()).map((s,l)=>e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:e.jsx("i",{className:`${s.file?E(s.file.name):"ri-file-line"} text-blue-600`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 truncate",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx("span",{className:"capitalize",children:s.category}),s.file&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:q(s.file.size)})]})]})]})]},s.id))}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsx("i",{className:"ri-information-line mr-1"}),S.filter(e=>e.title.trim()).length," material",1!==S.filter(e=>e.title.trim()).length?"s":""," will be available for download"]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-information-line text-blue-600 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"Ready to Publish?"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Once published, your course will be available to students. You can always edit the content later from your dashboard."})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between pt-6 border-t border-gray-200 space-y-3 sm:space-y-0",children:[e.jsxs(i,{variant:"outline",onClick:()=>c(Math.max(1,d-1)),disabled:1===d,fullWidth:window.innerWidth<640,children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Previous"]}),d<4?e.jsxs(i,{onClick:()=>{if(!(e=>{switch(e){case 1:return""!==y.title.trim()&&""!==y.description.trim()&&""!==y.category&&""!==y.level&&""!==y.price;case 2:return w.every(e=>{const s=""!==e.title.trim(),l="youtube"===e.videoType?A(e.videoUrl):null!==e.videoFile;return s&&l});default:return!0}})(d))return 2!==d||(()=>{const e=w.map(e=>e.title.trim().toLowerCase()).filter(e=>""!==e);return e.length===new Set(e).size})()?void alert("Please fill all required fields before proceeding."):void alert("Please ensure all lesson titles are unique.");c(Math.min(4,d+1))},fullWidth:window.innerWidth<640,children:["Next",e.jsx("i",{className:"ri-arrow-right-line ml-2"})]}):e.jsxs(i,{onClick:async()=>{try{if(u(!0),g(""),h(""),!f)return void g("You must be logged in to create a course.");console.log("üöÄ Creating course with data:",y),console.log("üöÄ Lessons:",w);const l={title:y.title,description:y.description,category:y.category,instructor_id:f.id,price:parseInt(y.price)||0,duration_hours:parseInt(y.duration)||0,level:y.level.toLowerCase(),objectives:y.objectives.filter(e=>""!==e.trim()),requirements:y.requirements.filter(e=>""!==e.trim()),tags:y.tags.split(",").map(e=>e.trim()).filter(e=>""!==e),thumbnail:y.coverImage,lessons:w.map(e=>({title:e.title,videoType:e.videoType,videoUrl:e.videoUrl,language:e.language,description:e.description}))};console.log("üöÄ Course data for database:",l);const r=await a.createCourse(l);if(console.log("‚úÖ Course created successfully:",r),S.length>0&&S.some(e=>e.file&&e.title.trim())){console.log("üìÅ Uploading course materials...");const s=S.filter(e=>e.file&&e.title.trim());for(const l of s)if(l.file)try{await a.uploadCourseMaterial(r.id,l.file,{title:l.title,description:l.description,category:l.category,lessonId:l.lessonId?parseInt(l.lessonId.toString()):void 0}),console.log(`‚úÖ Material uploaded: ${l.title}`)}catch(e){console.error(`‚ùå Error uploading material ${l.title}:`,e)}}h("Course created successfully! Redirecting to courses..."),setTimeout(()=>{s("/mentor/courses")},2e3)}catch(l){console.error("‚ùå Error creating course:",l),g(`Failed to create course: ${l instanceof Error?l.message:"Unknown error"}`)}finally{u(!1)}},variant:"neon",fullWidth:window.innerWidth<640,disabled:m,children:[e.jsx("i",{className:"ri-upload-line mr-2"}),m?"Creating Course...":"Publish Course"]})]})]})]})};export{d as default};
