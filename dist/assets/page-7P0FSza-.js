import{j as e}from"./index-tBdcIxzk.js";import{r as s,b as l}from"./vendor-D_DxLZN2.js";import{C as t}from"./Card-CCr5q94u.js";import{B as r}from"./Button-q_HxaLrT.js";import{D as a}from"./dataService-7pESmbQL.js";import{authService as i}from"./auth-CFgD0Kdo.js";import{a as n}from"./router-BPhEMSNK.js";import"./supabase-BMSNwJ-5.js";import"./supabase-DCVaQTjR.js";const d=()=>{var d,c,o,x,m;const u=n(),[h,g]=s.useState([]),[j,p]=s.useState(!0),[b,v]=s.useState(""),[N,y]=s.useState(null),[f,w]=s.useState(null),[C,k]=s.useState(null),[T,U]=s.useState(null),[S,L]=s.useState(!1),[F,D]=s.useState({title:"",description:"",category:"",level:"",price:"",duration_hours:"",objectives:[""],requirements:[""],tags:""}),[E,_]=s.useState({title:"",videoType:"youtube",videoUrl:"",videoFile:null,language:"English",description:""}),[q,P]=s.useState(null),[I,R]=s.useState(null),[M,A]=s.useState(!1),[z,Y]=s.useState(!1),[O,V]=s.useState(""),[B,H]=s.useState("");s.useEffect(()=>{W()},[]);const W=async()=>{try{p(!0);const e=await i.getCurrentUser();if(!e)return void v("Please log in to view your courses");y(e);const s=(await a.getCourses()).filter(s=>s.instructor_id===e.id);g(s),console.log("‚úÖ Mentor courses loaded:",s)}catch(e){console.error("‚ùå Error loading mentor courses:",e),v("Failed to load courses. Please try again.")}finally{p(!1)}},$=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),G=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),J=e=>{console.log("‚úèÔ∏è Editing course:",e.id),k(e),D({title:e.title,description:e.description,category:e.category,level:e.level,price:e.price.toString(),duration_hours:e.duration_hours.toString(),objectives:e.objectives||[""],requirements:e.requirements||[""],tags:e.tags?e.tags.join(", "):""})},K=(e,s)=>{D(l=>({...l,[e]:s}))},Q=(e,s)=>{_(l=>({...l,[e]:s}))},X=e=>/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+/.test(e),Z=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},ee=()=>{w(null),k(null),U(null),P(null),L(!1),V(""),H("")};return j?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading your courses..."})]})})}):b?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs(t,{className:"text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-4xl"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Courses"}),e.jsx("p",{className:"text-gray-600 mb-4",children:b}),e.jsxs(r,{onClick:W,variant:"outline",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Try Again"]})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Courses"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage and track your own published courses"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex space-x-3",children:[e.jsxs(r,{onClick:()=>window.location.href="/mentor/all-courses",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium transition-all duration-200",children:[e.jsx("i",{className:"ri-book-2-line mr-2"}),"All Courses"]}),e.jsxs(r,{onClick:()=>window.location.href="/mentor/upload-course",variant:"neon",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Create New Course"]}),e.jsxs(r,{onClick:W,variant:"outline",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx("i",{className:"ri-book-open-line text-2xl text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Courses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.length})]})]})}),e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx("i",{className:"ri-user-line text-2xl text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.reduce((e,s)=>e+(s.students_count||0),0)})]})]})}),e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx("i",{className:"ri-money-rupee-circle-line text-2xl text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$(h.reduce((e,s)=>e+s.price*(s.students_count||0),0))})]})]})}),e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx("i",{className:"ri-star-line text-2xl text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Rating"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.length>0?(h.reduce((e,s)=>e+(s.rating||0),0)/h.length).toFixed(1):"0.0"})]})]})})]}),0===h.length?e.jsxs(t,{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("i",{className:"ri-book-open-line text-6xl"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Courses Yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Start creating your first course to share your knowledge with students."}),e.jsxs(r,{onClick:()=>window.location.href="/mentor/upload-course",variant:"neon",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Create Your First Course"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(s=>e.jsxs(t,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"aspect-video bg-gray-200 relative",children:[s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"ri-book-open-line text-4xl text-gray-400"})}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:"bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium",children:s.level})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-3",children:e.jsx("span",{className:"text-sm text-blue-600 font-medium",children:s.category})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:s.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-time-line mr-1"}),e.jsxs("span",{children:[s.duration_hours,"h"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-user-line mr-1"}),e.jsxs("span",{children:[s.students_count||0," students"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-star-line mr-1"}),e.jsx("span",{children:s.rating||0})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900",children:$(s.price)}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>(e=>{console.log("‚ûï Adding lesson to course:",e.id),U(e),L(!1),_({title:"",videoType:"youtube",videoUrl:"",videoFile:null,language:"English",description:""})})(s),title:"Add New Lesson",className:"text-green-600 hover:text-green-700 hover:border-green-300",children:e.jsx("i",{className:"ri-add-line"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>J(s),title:"Edit Course",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>u(`/mentor/materials?course=${s.id}`),title:"Manage Materials",children:e.jsx("i",{className:"ri-file-line"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>(e=>{console.log("üîç Viewing course:",e.id),w(e)})(s),title:"View Course Details",children:e.jsx("i",{className:"ri-eye-line"})})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Created on ",G(s.created_at)]})})]})]},s.id))}),O&&e.jsx("div",{className:"fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded z-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-check-line mr-2"}),O]})}),B&&e.jsx("div",{className:"fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded z-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-check-line mr-2"}),B]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Course Details"}),e.jsx("button",{onClick:ee,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"aspect-video bg-gray-200 rounded-lg mb-4 relative",children:[f.thumbnail?e.jsx("img",{src:f.thumbnail,alt:f.title,className:"w-full h-full object-cover rounded-lg"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"ri-book-open-line text-6xl text-gray-400"})}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:f.level})})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:f.title}),e.jsx("p",{className:"text-gray-600 text-lg",children:f.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Category"}),e.jsx("p",{className:"text-gray-900",children:f.category})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Duration"}),e.jsxs("p",{className:"text-gray-900",children:[f.duration_hours," hours"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Price"}),e.jsx("p",{className:"text-gray-900 text-xl font-bold",children:$(f.price)})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Students"}),e.jsxs("p",{className:"text-gray-900",children:[f.students_count||0," enrolled"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Rating"}),e.jsxs("p",{className:"text-gray-900",children:[f.rating||0,"/5"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Created"}),e.jsx("p",{className:"text-gray-900",children:G(f.created_at)})]})]})]}),f.objectives&&f.objectives.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Course Objectives"}),e.jsx("ul",{className:"space-y-2",children:f.objectives.map((s,l)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-check-line text-green-600 mt-1 mr-2"}),e.jsx("span",{className:"text-gray-700",children:s})]},l))})]}),f.requirements&&f.requirements.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Requirements"}),e.jsx("ul",{className:"space-y-2",children:f.requirements.map((s,l)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-arrow-right-line text-blue-600 mt-1 mr-2"}),e.jsx("span",{className:"text-gray-700",children:s})]},l))})]}),f.tags&&f.tags.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:f.tags.map((s,l)=>e.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm",children:s},l))})]}),f.lessons&&f.lessons.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:["Lessons (",f.lessons.length,")"]}),e.jsx("div",{className:"space-y-3",children:f.lessons.map((s,l)=>e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"youtube"===s.videoType?e.jsx("i",{className:"ri-youtube-line text-red-600"}):e.jsx("i",{className:"ri-video-line text-blue-600"})})]})},l))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx(r,{variant:"outline",onClick:ee,children:"Close"}),e.jsxs(r,{onClick:()=>{ee(),J(f)},children:[e.jsx("i",{className:"ri-edit-line mr-2"}),"Edit Course"]})]})]})})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Course"}),e.jsx("button",{onClick:ee,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course Title *"}),e.jsx("input",{type:"text",value:F.title,onChange:e=>K("title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter course title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{value:F.category,onChange:e=>K("category",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Web Development",children:"Web Development"}),e.jsx("option",{value:"Data Science",children:"Data Science"}),e.jsx("option",{value:"Mobile Development",children:"Mobile Development"}),e.jsx("option",{value:"DevOps",children:"DevOps"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{value:F.description,onChange:e=>K("description",e.target.value),rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter course description"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level *"}),e.jsxs("select",{value:F.level,onChange:e=>K("level",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Level"}),e.jsx("option",{value:"Beginner",children:"Beginner"}),e.jsx("option",{value:"Intermediate",children:"Intermediate"}),e.jsx("option",{value:"Advanced",children:"Advanced"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (‚Çπ) *"}),e.jsx("input",{type:"number",value:F.price,onChange:e=>K("price",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (Hours) *"}),e.jsx("input",{type:"number",value:F.duration_hours,onChange:e=>K("duration_hours",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course Objectives"}),e.jsxs("div",{className:"space-y-2",children:[F.objectives.map((s,l)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:s,onChange:e=>{const s=[...F.objectives];s[l]=e.target.value,K("objectives",s)},className:"flex-1 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter objective"}),e.jsx("button",{type:"button",onClick:()=>(e=>{D(s=>({...s,objectives:s.objectives.filter((s,l)=>l!==e)}))})(l),className:"text-red-600 hover:text-red-800",children:e.jsx("i",{className:"ri-delete-bin-line"})})]},l)),e.jsxs("button",{type:"button",onClick:()=>{D(e=>({...e,objectives:[...e.objectives,""]}))},className:"text-blue-600 hover:text-blue-800 text-sm",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Add Objective"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course Requirements"}),e.jsxs("div",{className:"space-y-2",children:[F.requirements.map((s,l)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:s,onChange:e=>{const s=[...F.requirements];s[l]=e.target.value,K("requirements",s)},className:"flex-1 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter requirement"}),e.jsx("button",{type:"button",onClick:()=>(e=>{D(s=>({...s,requirements:s.requirements.filter((s,l)=>l!==e)}))})(l),className:"text-red-600 hover:text-red-800",children:e.jsx("i",{className:"ri-delete-bin-line"})})]},l)),e.jsxs("button",{type:"button",onClick:()=>{D(e=>({...e,requirements:[...e.requirements,""]}))},className:"text-blue-600 hover:text-blue-800 text-sm",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Add Requirement"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),e.jsx("input",{type:"text",value:F.tags,onChange:e=>K("tags",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter tags separated by commas"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx(r,{variant:"outline",onClick:ee,disabled:M,children:"Cancel"}),e.jsx(r,{onClick:async()=>{if(C)try{A(!0),V("");const e={title:F.title,description:F.description,category:F.category,level:F.level.toLowerCase(),price:parseInt(F.price)||0,duration_hours:parseInt(F.duration_hours)||0,objectives:F.objectives.filter(e=>""!==e.trim()),requirements:F.requirements.filter(e=>""!==e.trim()),tags:F.tags.split(",").map(e=>e.trim()).filter(e=>""!==e),updated_at:(new Date).toISOString()};console.log("üíæ Updating course with data:",e),await a.updateCourse(C.id,e),g(s=>s.map(s=>s.id===C.id?{...s,...e}:s)),V("Course updated successfully!"),k(null),setTimeout(()=>V(""),3e3)}catch(e){console.error("‚ùå Error updating course:",e),v("Failed to update course. Please try again.")}finally{A(!1)}},disabled:M,children:M?e.jsxs(l.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]},"edit-loading"):e.jsxs(l.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),"Save Changes"]},"edit-save")})]})]})})}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Lessons"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:['Manage lessons for "',T.title,'"']})]}),e.jsx("button",{onClick:ee,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-green-800",children:["Add New Lesson (Lesson ",((null==(d=T.lessons)?void 0:d.length)||0)+1,")"]}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Click the action button to add a new lesson"})]}),e.jsxs(r,{onClick:()=>{L(!0),_({title:"",videoType:"youtube",videoUrl:"",videoFile:null,language:"English",description:""})},className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Add Lesson ",((null==(c=T.lessons)?void 0:c.length)||0)+1]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Existing Lessons (",(null==(o=T.lessons)?void 0:o.length)||0,")"]}),T.lessons&&T.lessons.length>0?e.jsx("div",{className:"space-y-3",children:T.lessons.map((s,l)=>e.jsxs("div",{className:"flex items-center p-4 bg-gray-50 border border-gray-200 rounded-lg hover:shadow-sm transition-shadow cursor-move",draggable:!0,onDragStart:e=>((e,s)=>{R(s),e.dataTransfer.effectAllowed="move"})(e,s.id),onDragOver:Z,onDrop:e=>(async(e,s,l)=>{if(e.preventDefault(),null===I||I===s)return;const t=h.find(e=>e.id===l);if(!t||!t.lessons)return;const r=t.lessons.findIndex(e=>e.id===I),i=t.lessons.findIndex(e=>e.id===s),n=[...t.lessons],d=n.splice(r,1)[0];n.splice(i,0,d);const c=n.map((e,s)=>({...e,id:s+1}));try{await a.updateCourse(l,{lessons:c,updated_at:(new Date).toISOString()}),g(e=>e.map(e=>e.id===l?{...e,lessons:c}:e)),H("Lessons reordered successfully!"),setTimeout(()=>H(""),3e3)}catch(o){console.error("‚ùå Error reordering lessons:",o),v("Failed to reorder lessons. Please try again.")}R(null)})(e,s.id,T.id),children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-drag-move-line text-gray-400"}),e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-medium text-sm",children:s.id})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-global-line mr-1"}),s.language]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:("youtube"===s.videoType?"ri-youtube-line text-red-600":"ri-video-line text-blue-600")+" mr-1"}),"youtube"===s.videoType?"YouTube":"Upload"]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(r,{variant:"outline",size:"sm",onClick:()=>((e,s)=>{console.log("‚úèÔ∏è Editing lesson:",e.id),P({...e,courseId:s.id}),_({title:e.title,videoType:e.videoType,videoUrl:e.videoUrl,videoFile:null,language:e.language,description:e.description})})(s,T),title:"Edit Lesson",children:e.jsx("i",{className:"ri-edit-line"})})})]},s.id))}):e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx("i",{className:"ri-video-line text-4xl text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No lessons added yet"})]})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:e.jsx(r,{variant:"outline",onClick:ee,disabled:z,children:"Close"})})]})})}),S&&T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add New Lesson"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Add Lesson ",((null==(x=T.lessons)?void 0:x.length)||0)+1,' to "',T.title,'"']})]}),e.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lesson Title *"}),e.jsx("input",{type:"text",value:E.title,onChange:e=>Q("title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter lesson title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),e.jsxs("select",{value:E.language,onChange:e=>Q("language",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"English",children:"English"}),e.jsx("option",{value:"Telugu",children:"‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)"}),e.jsx("option",{value:"Hindi",children:"‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Video Source *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"videoType",value:"youtube",checked:"youtube"===E.videoType,onChange:e=>Q("videoType",e.target.value),className:"mr-2"}),e.jsx("span",{children:"YouTube URL"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"videoType",value:"upload",checked:"upload"===E.videoType,onChange:e=>Q("videoType",e.target.value),className:"mr-2"}),e.jsx("span",{children:"Upload MP4"})]})]})]}),"youtube"===E.videoType?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"YouTube URL *"}),e.jsx("input",{type:"url",value:E.videoUrl,onChange:e=>Q("videoUrl",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://www.youtube.com/watch?v=..."}),E.videoUrl&&!X(E.videoUrl)&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:"Please enter a valid YouTube URL"}),E.videoUrl&&X(E.videoUrl)&&e.jsx("div",{className:"text-green-600 text-sm mt-1",children:"‚úì Valid YouTube URL"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Video File *"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:"video/mp4",onChange:e=>{var s;return Q("videoFile",(null==(s=e.target.files)?void 0:s[0])||null)},className:"hidden",id:"video-upload"}),e.jsxs("label",{htmlFor:"video-upload",className:"cursor-pointer",children:[e.jsx("i",{className:"ri-upload-cloud-line text-3xl text-gray-400 mb-2"}),e.jsxs("div",{className:"text-gray-600",children:["Drop your MP4 file here or ",e.jsx("span",{className:"text-blue-600",children:"click to browse"})]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Maximum file size: 500MB"})]}),E.videoFile&&e.jsxs("div",{className:"mt-3 text-sm text-green-600",children:["‚úì File selected: ",E.videoFile.name]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{value:E.description,onChange:e=>Q("description",e.target.value),rows:3,maxLength:300,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of what this lesson covers"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[E.description.length,"/300 characters"]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx(r,{variant:"outline",onClick:()=>L(!1),disabled:z,children:"Cancel"}),e.jsx(r,{onClick:async()=>{if(T)try{if(Y(!0),H(""),!E.title.trim())return void v("Please enter a lesson title");if("youtube"===E.videoType&&!X(E.videoUrl))return void v("Please enter a valid YouTube URL");if("upload"===E.videoType&&!E.videoFile)return void v("Please select a video file");const e=T.lessons||[],s={id:e.length+1,title:E.title,videoType:E.videoType,videoUrl:E.videoUrl,language:E.language,description:E.description},l=[...e,s];await a.updateCourse(T.id,{lessons:l,updated_at:(new Date).toISOString()}),g(e=>e.map(e=>e.id===T.id?{...e,lessons:l}:e)),H("Lesson added successfully!"),L(!1),U(e=>e?{...e,lessons:l}:null),setTimeout(()=>H(""),3e3)}catch(e){console.error("‚ùå Error adding lesson:",e),v("Failed to add lesson. Please try again.")}finally{Y(!1)}else console.log("‚ùå No course selected for adding lesson")},disabled:z,className:"bg-green-600 hover:bg-green-700",children:z?e.jsxs(l.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding Lesson..."]},"lesson-loading"):e.jsxs(l.Fragment,{children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Add Lesson ",((null==(m=T.lessons)?void 0:m.length)||0)+1]},"lesson-add")})]})]})})}),q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Edit Lesson ",q.id]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Update lesson details"})]}),e.jsx("button",{onClick:()=>P(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lesson Title *"}),e.jsx("input",{type:"text",value:E.title,onChange:e=>Q("title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter lesson title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),e.jsxs("select",{value:E.language,onChange:e=>Q("language",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"English",children:"English"}),e.jsx("option",{value:"Telugu",children:"‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)"}),e.jsx("option",{value:"Hindi",children:"‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Video Source *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"editVideoType",value:"youtube",checked:"youtube"===E.videoType,onChange:e=>Q("videoType",e.target.value),className:"mr-2"}),e.jsx("span",{children:"YouTube URL"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"editVideoType",value:"upload",checked:"upload"===E.videoType,onChange:e=>Q("videoType",e.target.value),className:"mr-2"}),e.jsx("span",{children:"Upload MP4"})]})]})]}),"youtube"===E.videoType?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"YouTube URL *"}),e.jsx("input",{type:"url",value:E.videoUrl,onChange:e=>Q("videoUrl",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://www.youtube.com/watch?v=..."}),E.videoUrl&&!X(E.videoUrl)&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:"Please enter a valid YouTube URL"}),E.videoUrl&&X(E.videoUrl)&&e.jsx("div",{className:"text-green-600 text-sm mt-1",children:"‚úì Valid YouTube URL"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Video File *"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:"video/mp4",onChange:e=>{var s;return Q("videoFile",(null==(s=e.target.files)?void 0:s[0])||null)},className:"hidden",id:"edit-video-upload"}),e.jsxs("label",{htmlFor:"edit-video-upload",className:"cursor-pointer",children:[e.jsx("i",{className:"ri-upload-cloud-line text-3xl text-gray-400 mb-2"}),e.jsxs("div",{className:"text-gray-600",children:["Drop your MP4 file here or ",e.jsx("span",{className:"text-blue-600",children:"click to browse"})]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Maximum file size: 500MB"})]}),E.videoFile&&e.jsxs("div",{className:"mt-3 text-sm text-green-600",children:["‚úì File selected: ",E.videoFile.name]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{value:E.description,onChange:e=>Q("description",e.target.value),rows:3,maxLength:300,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of what this lesson covers"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[E.description.length,"/300 characters"]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx(r,{variant:"outline",onClick:()=>P(null),disabled:z,children:"Cancel"}),e.jsx(r,{onClick:async()=>{var e;if(q)try{if(Y(!0),H(""),!E.title.trim())return void v("Please enter a lesson title");if("youtube"===E.videoType&&!X(E.videoUrl))return void v("Please enter a valid YouTube URL");const s=h.find(e=>e.id===q.courseId);if(!s)return;const l=(null==(e=s.lessons)?void 0:e.map(e=>e.id===q.id?{...e,title:E.title,videoType:E.videoType,videoUrl:E.videoUrl,language:E.language,description:E.description}:e))||[];await a.updateCourse(q.courseId,{lessons:l,updated_at:(new Date).toISOString()}),g(e=>e.map(e=>e.id===q.courseId?{...e,lessons:l}:e)),H("Lesson updated successfully!"),P(null),setTimeout(()=>H(""),3e3)}catch(s){console.error("‚ùå Error updating lesson:",s),v("Failed to update lesson. Please try again.")}finally{Y(!1)}},disabled:z,className:"bg-blue-600 hover:bg-blue-700",children:z?e.jsxs(l.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]},"lesson-update-loading"):e.jsxs(l.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),"Update Lesson"]},"lesson-update-save")})]})]})})})]})})};export{d as default};
