import{j as e,a as s}from"./index-BaWXG3YY.js";import{r as t}from"./vendor-D_DxLZN2.js";import{d as l,L as i}from"./router-BbFJyaaj.js";import{C as a}from"./Card-CQri447u.js";import{B as r}from"./Button-lmmCuxjA.js";import{M as n}from"./Modal-C5SmEZl1.js";import{D as o}from"./dataService-M2AFkWLp.js";import{b as c}from"./bookmarkService-85gV1Kv-.js";import{g as d,i as x,C as m}from"./globalPreloader-DDOHh7_j.js";import"./supabase-DnW1kxsT.js";const u=({title:s,children:l,defaultExpanded:i=!1,icon:a,className:r=""})=>{const[n,o]=t.useState(i);return e.jsxs("div",{className:`border-b border-gray-200 ${r}`,children:[e.jsxs("button",{onClick:()=>o(!n),className:"w-full flex items-center justify-between py-3 px-4 text-left hover:bg-gray-50 transition-colors duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[a&&e.jsx("i",{className:`${a} text-lg text-gray-600`}),e.jsx("span",{className:"font-medium text-gray-900",children:s})]}),e.jsx("i",{className:`ri-arrow-${n?"up":"down"}-s-line text-lg text-gray-500 transition-transform duration-200`})]}),n&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx("div",{className:"text-gray-700 leading-relaxed",children:l})})]})},h=()=>{var h;const{courseId:g}=l(),[j,p]=t.useState(1),[f,b]=t.useState([]),[y,v]=t.useState(!1),[N,w]=t.useState(""),[k,C]=t.useState("general"),[S,T]=t.useState(""),[M,D]=t.useState([]),[P,E]=t.useState("english"),[I,U]=t.useState(null),[q,B]=t.useState(!0),[L,A]=t.useState(""),[z,$]=t.useState(null),[F,Q]=t.useState(!1),[R,O]=t.useState([]),[W,J]=t.useState([]),[V,Y]=t.useState(!1);t.useEffect(()=>{g&&H()},[g]);const H=async()=>{try{B(!0),A("");const e=await s.getCurrentUser();if(!e)return void A("Please log in to access course content");$(e),console.log("ðŸ”„ Fetching course data for:",g);if(!(await o.isStudentEnrolled(e.id,g)))return void A("You are not enrolled in this course. Please enroll first to access course content.");const t=(await o.getCourses()).find(e=>e.id===g);if(!t)return void A("Course not found");const l={...t,objectives:t.objectives||["Learn the fundamentals of ReactJS and its core concepts","Understand JSX syntax and component structure","Master state management with useState and useEffect hooks","Build interactive user interfaces with React components","Implement routing and navigation in React applications","Deploy React applications to production environments"],requirements:t.requirements||["Basic knowledge of HTML, CSS, and JavaScript","Understanding of ES6+ JavaScript features","Node.js and npm installed on your computer","A code editor like VS Code","Basic understanding of web development concepts"],tags:t.tags||["React","JavaScript","Frontend","Web Development","UI/UX","Beginner Friendly"]};U(l),console.log("âœ… Course data loaded:",l);const i=c.getBookmarks().filter(e=>e.courseId===g).map(e=>parseInt(e.lessonId));b(i);const a=((null==t?void 0:t.lessons)||[]).map(e=>e.videoUrl).filter(Boolean);if(a.length>0){console.log("ðŸš€ INSTANT PRELOAD: Starting preload for",a.length,"videos");const e=performance.now();a.forEach(e=>d.addToPreloadQueue(e)),a.length>0&&x.preloadVideo(a[0]).then(()=>{const s=(performance.now()-e).toFixed(2);console.log(`ðŸš€ INSTANT PRELOAD: First video ready in ${s}ms`)})}}catch(e){console.error("âŒ Error loading course data:",e),A("Failed to load course content. Please try again.")}finally{B(!1)}},X=(null==I?void 0:I.lessons)||[{id:1,title:"Course Introduction",videoType:"youtube",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ",language:"english",description:"Welcome to the course!"}],_=X.find((e,s)=>s+1===j)||X[0];if(q)return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading course content..."})]})})});if(L||!I)return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs(a,{className:"text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-4xl"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Course"}),e.jsx("p",{className:"text-gray-600 mb-4",children:L||"Course not found"}),e.jsx(i,{to:"/student/my-courses",children:e.jsxs(r,{variant:"outline",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to My Courses"]})})]})})});const G=async e=>{try{console.log("ðŸ“¥ Starting download for material ID:",e);const{url:s,error:t}=await o.getMaterialDownloadUrl(e);if(t||!s)throw console.error("âŒ Download URL error:",t),new Error((null==t?void 0:t.message)||"Failed to get download URL");console.log("âœ… Download URL obtained, starting download...");const l=document.createElement("a");return l.href=s,l.download="",l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l),console.log("âœ… Download initiated successfully"),!0}catch(s){throw console.error("âŒ Download failed:",s),s.message.includes("Object not found")?new Error("File not found in storage. Please contact your instructor."):s.message.includes("Material not found")?new Error("Material not found. It may have been removed."):s.message.includes("file path is missing")?new Error("File path is missing. Please contact your instructor."):new Error(`Download failed: ${s.message}`)}};return e.jsxs("div",{className:"space-y-6",children:[S&&e.jsx("div",{className:"fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-slide-in-right",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-check-circle-line mr-2"}),S]})}),e.jsxs("nav",{className:"flex text-sm text-gray-500",children:[e.jsx(i,{to:"/student/my-courses",className:"hover:text-blue-600",children:"My Courses"}),e.jsx("i",{className:"ri-arrow-right-s-line mx-2"}),e.jsx("span",{className:"text-gray-900",children:I.title})]}),e.jsxs(a,{className:"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:I.title}),e.jsxs("p",{className:"text-gray-600",children:["by ",(null==(h=I.instructor)?void 0:h.name)||"Mentor"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Progress"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[X.length>0?Math.round(M.length/X.length*100):0,"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-4",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:{width:(X.length>0?M.length/X.length*100:0)+"%"}})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:[M.length," of ",X.length," lessons completed"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-gray-500",children:[I.level," â€¢ ",I.duration_hours,"h"]}),e.jsxs("select",{value:P,onChange:e=>E(e.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm pr-8",children:[e.jsx("option",{value:"english",children:"English"}),e.jsx("option",{value:"spanish",children:"Spanish"}),e.jsx("option",{value:"french",children:"French"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(a,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:_.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>(e=>{var s,t;if(!I)return;const l=e.toString();if(c.isBookmarked(I.id,l))c.removeBookmarkByLesson(I.id,l)&&(b(s=>s.filter(s=>s!==e)),T("Bookmark removed successfully!"));else{const i=null==(s=I.lessons)?void 0:s.find(s=>s.id===e);i&&c.addBookmark({courseId:I.id,courseTitle:I.title,lessonTitle:i.title,lessonId:l,instructor:(null==(t=I.instructor)?void 0:t.name)||"Unknown Instructor",progress:0,lessonDuration:i.duration||"Unknown",thumbnailUrl:I.thumbnail})&&(b(s=>[...s,e]),T("Lesson bookmarked successfully!"))}setTimeout(()=>T(""),3e3)})(_.id),className:"p-2 rounded-lg transition-colors "+(f.includes(_.id)?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.jsx("i",{className:f.includes(_.id)?"ri-bookmark-fill":"ri-bookmark-line"})}),e.jsx("button",{onClick:()=>v(!0),className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",title:"Ask a question - will be added to your discussions",children:e.jsx("i",{className:"ri-question-line"})})]})]}),_&&e.jsxs("div",{className:"space-y-4",children:[_.videoUrl?e.jsx(m,{videoUrl:_.videoUrl,title:_.title,forceCustomPlayer:!0,progressCheckpoints:[10,30,60,120,300],onProgressCheckpoint:async(e,s)=>(console.log(`ðŸŽ¯ Checkpoint reached at ${e}s (checkpoint: ${s}s)`),await new Promise(e=>setTimeout(e,2e3+3e3*Math.random())),console.log(`âœ… Data processing complete for checkpoint ${s}s`),!0),onTimeUpdate:(e,s)=>{console.log(`Video progress: ${e}/${s}`)}}):e.jsx("div",{className:"relative bg-black rounded-lg overflow-hidden flex items-center justify-center",style:{aspectRatio:"16/9"},children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("i",{className:"ri-video-line text-4xl mb-2"}),e.jsx("p",{children:"No video available"})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Language: ",_.language||"English"]}),!M.includes(j)&&e.jsxs(r,{size:"sm",onClick:()=>{return e=j,void(M.includes(e)||(D(s=>[...s,e]),T("Lesson marked as complete!"),setTimeout(()=>T(""),3e3)));var e},children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Mark Complete"]})]}),e.jsxs("div",{className:"mt-6 bg-white border border-gray-200 rounded-lg overflow-hidden",children:[_.description&&e.jsx(u,{title:"Description",icon:"ri-file-text-line",defaultExpanded:!0,children:e.jsx("p",{children:_.description})}),(null==I?void 0:I.objectives)&&I.objectives.length>0&&e.jsx(u,{title:"Course Objectives",icon:"ri-target-line",children:e.jsx("ul",{className:"space-y-2",children:I.objectives.map((s,t)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("i",{className:"ri-checkbox-circle-line text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:s})]},t))})}),(null==I?void 0:I.requirements)&&I.requirements.length>0&&e.jsx(u,{title:"Course Requirements",icon:"ri-list-check-2",children:e.jsx("ul",{className:"space-y-2",children:I.requirements.map((s,t)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("i",{className:"ri-arrow-right-s-line text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:s})]},t))})}),(null==I?void 0:I.tags)&&I.tags.length>0&&e.jsx(u,{title:"Course Tags",icon:"ri-price-tag-3-line",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:I.tags.map((s,t)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:s},t))})})]})]}),"quiz"===_.type&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-question-line text-2xl text-orange-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Interactive Quiz"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Test your knowledge with this interactive quiz"}),e.jsx(r,{children:"Start Quiz"})]}),"project"===_.type&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-code-line text-2xl text-purple-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Hands-on Project"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Apply what you've learned in this practical project"}),e.jsx(r,{children:"Start Project"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(r,{variant:"outline",disabled:1===j,onClick:()=>p(e=>Math.max(1,e-1)),children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Previous"]}),e.jsxs(r,{disabled:j===X.length,onClick:()=>p(e=>Math.min(X.length,e+1)),children:["Next",e.jsx("i",{className:"ri-arrow-right-line ml-2"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(a,{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Course Content"}),e.jsx("div",{className:"space-y-2",children:X.map((s,t)=>e.jsx("button",{onClick:()=>p(t+1),className:"w-full text-left p-3 rounded-lg transition-colors "+(j===t+1?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3 "+(M.includes(t+1)?"bg-green-100 text-green-600":j===t+1?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:e.jsx("i",{className:M.includes(t+1)?"ri-check-line":j===t+1?"ri-play-line":"ri-play-circle-line"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:s.title}),e.jsx("div",{className:"text-xs text-gray-500",children:s.language||"English"})]})]}),f.includes(t+1)&&e.jsx("i",{className:"ri-bookmark-fill text-yellow-500"})]})},t))})]}),e.jsxs(a,{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{variant:"outline",size:"sm",fullWidth:!0,onClick:async()=>{if(g)try{Y(!0),Q(!0);const e=await o.getCourseMaterials(g);console.log("ðŸ“‹ Materials received in frontend:",e),O(e||[]),e&&0!==e.length?console.log("âœ… Materials set in state:",e.length,"materials"):(T("No materials available for this course yet."),setTimeout(()=>T(""),3e3))}catch(e){console.error("Error loading materials:",e),T("Failed to load materials. Please try again."),setTimeout(()=>T(""),3e3)}finally{Y(!1)}},children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Download Materials"]}),e.jsxs(r,{variant:"outline",size:"sm",fullWidth:!0,children:[e.jsx("i",{className:"ri-team-line mr-2"}),"Join Study Group"]}),e.jsxs(r,{variant:"outline",size:"sm",fullWidth:!0,children:[e.jsx("i",{className:"ri-message-line mr-2"}),"Contact Instructor"]}),e.jsx(i,{to:"/student/discussions",children:e.jsxs(r,{variant:"outline",size:"sm",fullWidth:!0,children:[e.jsx("i",{className:"ri-chat-3-line mr-2"}),"View My Questions"]})})]})]})]})]}),e.jsxs(a,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Learning Path Progress"}),e.jsx("p",{className:"text-sm text-gray-600",children:I.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[M.length," of ",X.length," modules completed"]})]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:X.map((s,t)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mb-2 "+(M.includes(t+1)?"bg-green-100 text-green-600":j===t+1?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"),children:e.jsx("i",{className:M.includes(t+1)?"ri-check-line":j===t+1?"ri-play-line":"ri-lock-line"})}),e.jsx("span",{className:"text-xs text-gray-600 text-center max-w-16",children:s.title.length>12?s.title.substring(0,12)+"...":s.title})]},t))})]}),e.jsx(n,{isOpen:y,onClose:()=>v(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:e.jsx("i",{className:"ri-question-line text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ask a Question"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["About: ",_.title]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Category"}),e.jsxs("select",{value:k,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pr-8",children:[e.jsx("option",{value:"general",children:"General Question"}),e.jsx("option",{value:"technical",children:"Technical Issue"}),e.jsx("option",{value:"concept",children:"Concept Clarification"}),e.jsx("option",{value:"assignment",children:"Assignment Help"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Question"}),e.jsx("textarea",{value:N,onChange:e=>w(e.target.value),placeholder:"Type your question here...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[N.length,"/500 characters"]})]}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-information-line text-blue-600 mt-0.5 mr-2"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Your question will be:"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"â€¢ Added to your Discussions tab for easy tracking"}),e.jsx("li",{children:"â€¢ Sent to course mentors for expert answers"}),e.jsx("li",{children:"â€¢ Available for review and follow-up questions"}),e.jsx("li",{children:"â€¢ Mentors typically respond within 24 hours"})]})]})]})})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsxs(r,{onClick:()=>{if(N.trim()){const e={id:Date.now(),courseId:g||"1",courseTitle:I.title,lessonTitle:_.title,question:N.trim(),category:k,submittedAt:(new Date).toISOString(),status:"pending",replies:[],lastActivity:(new Date).toISOString()};console.log("Question submitted and added to discussions:",e),v(!1),w(""),C("general"),T("Your question has been submitted and added to your discussions!"),setTimeout(()=>T(""),3e3)}},disabled:!N.trim(),className:"flex-1",children:[e.jsx("i",{className:"ri-send-plane-line mr-2"}),"Submit Question"]}),e.jsx(r,{variant:"outline",onClick:()=>v(!1),children:"Cancel"})]})]})}),e.jsx(n,{isOpen:F,onClose:()=>Q(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:e.jsx("i",{className:"ri-download-line text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Download Course Materials"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Select materials to download"})]})]}),V?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading materials..."})]}):0===R.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ri-file-download-line text-4xl text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No materials available for this course yet."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Check back later or contact your instructor."}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Debug: availableMaterials.length = ",R.length]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:W.length===R.length,onChange:()=>{W.length===R.length?J([]):J(R.map(e=>e.id))},className:"mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["Select All (",R.length," files)"]})]}),W.length>0&&e.jsxs("span",{className:"text-sm text-gray-600",children:["Total: ",(K=W.reduce((e,s)=>{const t=R.find(e=>e.id===s);return t&&t.size?e+parseFloat(t.size)*(t.size.includes("MB")?1024:1):e},0),K>=1024?`${(K/1024).toFixed(1)} MB`:`${K.toFixed(1)} KB`)]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:R.map(s=>e.jsxs("div",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:W.includes(s.id),onChange:e=>{e.target.checked?J(e=>[...e,s.id]):J(e=>e.filter(e=>e!==s.id))},className:"mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:`ri-file-${"slides"===s.category?"ppt":"code"===s.category?"code":"handouts"===s.category?"text":"file"}-line text-blue-600 mr-2`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.size," â€¢ ",s.category," â€¢ ",s.download_count||0," downloads"]})]})]}),s.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:s.description})]})]},s.id))}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(r,{onClick:async()=>{if(0!==W.length)try{for(const e of W)await G(e),await new Promise(e=>setTimeout(e,500));T(`Successfully downloaded ${W.length} file${W.length>1?"s":""}!`),setTimeout(()=>T(""),3e3),Q(!1),J([])}catch(e){console.error("Download error:",e),T("Some downloads failed. Please try again."),setTimeout(()=>T(""),3e3)}},disabled:0===W.length,className:"flex-1",children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Download Selected (",W.length,")"]}),e.jsx(r,{variant:"outline",onClick:()=>Q(!1),children:"Cancel"})]})]})]})})]});var K};export{h as default};
