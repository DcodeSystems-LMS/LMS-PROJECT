import{j as e}from"./index-tBdcIxzk.js";import{r as s}from"./vendor-D_DxLZN2.js";import{L as l}from"./router-BPhEMSNK.js";import{C as i}from"./Card-CCr5q94u.js";import{B as a}from"./Button-q_HxaLrT.js";import{M as r}from"./Modal-DDvsaOV2.js";import{D as t}from"./dataService-7pESmbQL.js";import{authService as c}from"./auth-CFgD0Kdo.js";import"./supabase-BMSNwJ-5.js";import"./supabase-DCVaQTjR.js";function n(){var n;const[m,d]=s.useState([]),[x,o]=s.useState(null),[h,j]=s.useState(!1),[u,N]=s.useState(""),[g,f]=s.useState([]),[p,v]=s.useState(!0),[b,y]=s.useState(""),[w,C]=s.useState(null);s.useEffect(()=>{S(),k()},[]);const S=async()=>{try{v(!0),y("");const e=await c.getCurrentUser();if(!e)return void y("Please log in to view your wishlist");C(e),console.log("ðŸ”„ Fetching courses for wishlist...");const s=await t.getCourses();console.log("ðŸ“– All courses:",s),f(s),console.log("âœ… Wishlist data loaded successfully")}catch(e){console.error("âŒ Error loading wishlist data:",e),y("Failed to load courses. Please try again.")}finally{v(!1)}},k=()=>{const e=localStorage.getItem("courseWishlist");e&&d(JSON.parse(e))},E=e=>{localStorage.setItem("courseWishlist",JSON.stringify(e)),d(e)},I=g.filter(e=>m.includes(e.id)),W=async(e,s)=>{if(w)try{console.log("ðŸŽ“ Enrolling in course:",e),await t.enrollInCourse(w.id,e);const s=m.filter(s=>s!==e);E(s),j(!0),setTimeout(()=>j(!1),3e3),console.log("âœ… Successfully enrolled in course")}catch(l){console.error("âŒ Error enrolling in course:",l),y("Failed to enroll in course. Please try again.")}else y("Please log in to enroll in courses")},D=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return p?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading your wishlist..."})]})})}):b?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs(i,{className:"text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-4xl"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Wishlist"}),e.jsx("p",{className:"text-gray-600 mb-4",children:b}),e.jsxs(a,{onClick:S,variant:"outline",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Try Again"]})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Wishlist"}),e.jsxs("p",{className:"mt-2 text-gray-600",children:["Courses you've saved for later. ",I.length," course",1!==I.length?"s":""," saved."]})]}),e.jsx("div",{className:"mt-4 sm:mt-0 flex space-x-3",children:e.jsxs(a,{onClick:S,variant:"outline",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]})})]})}),h&&e.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-check-line text-green-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success!"}),e.jsx("div",{className:"mt-2 text-sm text-green-700",children:"You have successfully enrolled in the course!"})]})]})}),u&&e.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-heart-line text-blue-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Wishlist Updated"}),e.jsx("div",{className:"mt-2 text-sm text-blue-700",children:u})]})]})}),0===I.length?e.jsxs(i,{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("i",{className:"ri-heart-line text-6xl"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Your Wishlist is Empty"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Start exploring courses and add them to your wishlist to save them for later!"}),e.jsx(l,{to:"/student/my-courses",children:e.jsxs(a,{variant:"neon",children:[e.jsx("i",{className:"ri-search-line mr-2"}),"Browse Courses"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map(s=>{var l,r,t;return e.jsxs(i,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"aspect-video bg-gray-200 relative",children:[s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"ri-book-open-line text-4xl text-gray-400"})}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:"bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium",children:s.level})}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("i",{className:"ri-heart-fill text-red-500 text-xl"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-3",children:e.jsx("span",{className:"text-sm text-blue-600 font-medium",children:s.category})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:s.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:s.description}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:s.instructor?(t=s.instructor.name,t.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)):"M"})}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["by ",(null==(l=s.instructor)?void 0:l.name)||"Mentor"]})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-time-line mr-1"}),e.jsxs("span",{children:[s.duration_hours,"h"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-calendar-line mr-1"}),e.jsx("span",{children:(r=s.created_at,new Date(r).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}))})]})]}),e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"text-xl font-bold text-gray-900",children:D(s.price)})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(a,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>o(s),children:[e.jsx("i",{className:"ri-eye-line mr-1"}),"View Details"]}),e.jsxs(a,{size:"sm",className:"flex-1",onClick:()=>W(s.id,s.title),children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Enroll Now"]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs(a,{variant:"outline",size:"sm",className:"w-full text-red-600 border-red-300 hover:bg-red-50",onClick:()=>((e,s)=>{const l=m.filter(s=>s!==e);E(l),N(`"${s}" removed from wishlist!`),setTimeout(()=>N(""),3e3)})(s.id,s.title),children:[e.jsx("i",{className:"ri-heart-fill mr-2"}),"Remove from Wishlist"]})})]})]},s.id)})}),x&&e.jsx(r,{isOpen:!0,onClose:()=>o(null),title:x.title,size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:x.thumbnail?e.jsx("img",{className:"h-24 w-32 object-cover rounded-lg",src:x.thumbnail,alt:x.title}):e.jsx("div",{className:"h-24 w-32 bg-gray-200 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-book-open-line text-2xl text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:x.title}),e.jsx("p",{className:"text-gray-600 mb-3",children:x.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-user-line mr-1"}),"by ",(null==(n=x.instructor)?void 0:n.name)||"Mentor"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-time-line mr-1"}),x.duration_hours," hours"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-price-tag-3-line mr-1"}),D(x.price)]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Course Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Level:"}),e.jsx("span",{className:"font-medium",children:x.level})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Category:"}),e.jsx("span",{className:"font-medium",children:x.category})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsxs("span",{className:"font-medium",children:[x.duration_hours," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Price:"}),e.jsx("span",{className:"font-medium",children:D(x.price)})]})]})]}),x.objectives&&x.objectives.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Learning Objectives"}),e.jsx("ul",{className:"space-y-1 text-sm",children:x.objectives.map((s,l)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-check-line text-green-600 mt-1 mr-2"}),e.jsx("span",{className:"text-gray-700",children:s})]},l))})]})]}),x.requirements&&x.requirements.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Requirements"}),e.jsx("ul",{className:"space-y-1 text-sm",children:x.requirements.map((s,l)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-arrow-right-line text-blue-600 mt-1 mr-2"}),e.jsx("span",{className:"text-gray-700",children:s})]},l))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx(a,{variant:"outline",onClick:()=>o(null),children:"Close"}),e.jsxs(a,{onClick:()=>{W(x.id,x.title),o(null)},children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Enroll Now"]})]})]})})]})})}export{n as default};
