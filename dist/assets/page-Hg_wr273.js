import{j as e,a as s,s as t}from"./index-BaWXG3YY.js";import{r}from"./vendor-D_DxLZN2.js";import{C as n}from"./Card-CQri447u.js";import{B as a}from"./Button-lmmCuxjA.js";import{M as i}from"./Modal-C5SmEZl1.js";import{D as l}from"./dataService-M2AFkWLp.js";import{A as o,m as c}from"./proxy-BYna6Aqv.js";import"./router-BbFJyaaj.js";import"./supabase-DnW1kxsT.js";const d=({isOpen:s,score:t,totalQuestions:n,onComplete:a})=>{const[i,l]=r.useState(!1),[d,m]=r.useState(!1),[u,x]=r.useState(!1),[p,h]=r.useState(!1);r.useEffect(()=>{s&&(l(!1),m(!1),x(!1),h(!1),setTimeout(()=>l(!0),100),setTimeout(()=>m(!0),400),setTimeout(()=>x(!0),700),setTimeout(()=>h(!0),1e3))},[s]);const g=()=>{a()},f=Array.from({length:80},(e,s)=>({id:s,x:100*Math.random(),y:-10,rotation:360*Math.random(),color:["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#feca57","#ff9ff3","#a8e6cf","#ffd3a5","#ff7675","#74b9ff"][Math.floor(10*Math.random())]})),y=Array.from({length:12},(e,s)=>({id:s,x:100*Math.random(),y:100,color:["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#feca57","#ff9ff3","#a8e6cf","#ffd3a5","#ff7675","#74b9ff","#fd79a8","#fdcb6e"][s%12],delay:.15*s})),b=Array.from({length:30},(e,s)=>({id:s,x:100*Math.random(),y:100*Math.random(),size:4*Math.random()+2,delay:3*Math.random()})),j=Array.from({length:6},(e,s)=>({id:s,x:80*Math.random()+10,y:40*Math.random()+20,color:["#ff6b6b","#4ecdc4","#45b7d1","#feca57","#ff9ff3","#a8e6cf"][s%6],delay:.8*s,particles:Array.from({length:12},(e,s)=>({id:s,angle:30*s+15*Math.random(),distance:60*Math.random()+20}))}));return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 cursor-pointer",onClick:g,children:[e.jsx(o,{children:i&&e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:f.map(s=>e.jsx(c.div,{className:"absolute w-2 h-2 rounded-sm",style:{backgroundColor:s.color,left:`${s.x}%`,top:`${s.y}%`},initial:{y:-10,rotate:0,scale:0},animate:{y:window.innerHeight+10,rotate:s.rotation+360,scale:[0,1,.8,1,0]},transition:{duration:4,delay:.8*Math.random(),ease:"easeOut"},exit:{opacity:0}},s.id))})}),e.jsx(o,{children:d&&e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:y.map(s=>e.jsx(c.div,{className:"absolute",style:{left:`${s.x}%`,top:`${s.y}%`},initial:{y:window.innerHeight+50,scale:0,rotate:30*Math.random()-15},animate:{y:-100,scale:[0,1.2,1],rotate:30*Math.random()-15},transition:{duration:5,delay:s.delay,ease:"easeOut"},exit:{opacity:0},children:e.jsxs("div",{className:"w-8 h-10 rounded-full relative",style:{backgroundColor:s.color},children:[e.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-4 border-transparent",style:{borderTopColor:s.color}}),e.jsx("div",{className:"absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-0.5 h-4",style:{backgroundColor:"#8B4513"}})]})},s.id))})}),e.jsx(o,{children:u&&e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:b.map(s=>e.jsx(c.div,{className:"absolute",style:{left:`${s.x}%`,top:`${s.y}%`,width:s.size,height:s.size},initial:{scale:0,rotate:0,opacity:0},animate:{scale:[0,1.5,0],rotate:360,opacity:[0,1,0]},transition:{duration:1.5,delay:s.delay,repeat:1/0,repeatDelay:.5},exit:{opacity:0},children:e.jsx("div",{className:"w-full h-full bg-yellow-300 rounded-full shadow-lg shadow-yellow-300/50"})},s.id))})}),e.jsx(o,{children:p&&e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:j.map(s=>e.jsx(c.div,{className:"absolute",style:{left:`${s.x}%`,top:`${s.y}%`},initial:{scale:0,opacity:0},animate:{scale:[0,1,.8,1,0],opacity:[0,1,.8,1,0]},transition:{duration:2.5,delay:s.delay,ease:"easeOut"},exit:{opacity:0},children:s.particles.map(t=>e.jsx(c.div,{className:"absolute w-1 h-1 rounded-full",style:{backgroundColor:s.color,left:"50%",top:"50%",transformOrigin:"0 0"},initial:{x:0,y:0,scale:0},animate:{x:Math.cos(t.angle*Math.PI/180)*t.distance,y:Math.sin(t.angle*Math.PI/180)*t.distance,scale:[0,1,.8,0]},transition:{duration:1.5,delay:s.delay+.3,ease:"easeOut"}},t.id))},s.id))})}),e.jsxs(c.div,{className:"bg-white rounded-2xl p-8 text-center shadow-2xl max-w-md mx-4 relative overflow-hidden cursor-pointer",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0,y:[0,-5,0]},transition:{type:"spring",stiffness:300,damping:20,duration:.8,y:{duration:2,repeat:1/0,ease:"easeInOut"}},exit:{scale:0,rotate:180},onClick:e=>{e.stopPropagation(),g()},children:[e.jsxs("div",{className:"absolute inset-0 opacity-5",children:[e.jsx("div",{className:"absolute top-4 left-4 w-8 h-8 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute top-8 right-6 w-6 h-6 bg-pink-400 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-6 left-6 w-4 h-4 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute bottom-4 right-4 w-10 h-10 bg-green-400 rounded-full animate-pulse",style:{animationDelay:"1.5s"}})]}),e.jsx(c.div,{className:"text-6xl mb-4",animate:{rotate:[0,-10,10,-10,10,0],scale:[1,1.1,1]},transition:{duration:.6,delay:.5,repeat:2},children:"üéâ"}),e.jsx(c.h2,{className:"text-2xl font-bold text-gray-800 mb-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:"Assessment Complete!"}),e.jsxs(c.div,{className:`text-4xl font-bold ${N=t,N>=90?"text-yellow-500":N>=80?"text-green-500":N>=70?"text-blue-500":N>=60?"text-orange-500":"text-gray-500"} mb-2`,initial:{scale:0},animate:{scale:1},transition:{delay:1,type:"spring",stiffness:200},children:[t,"%"]}),e.jsx(c.p,{className:"text-lg text-gray-600 mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},children:(e=>e>=90?"Outstanding! üéâ":e>=80?"Excellent Work! üåü":e>=70?"Great Job! üëè":e>=60?"Good Work! üëç":"Keep Learning! üìö")(t)}),e.jsx(c.div,{className:"w-full bg-gray-200 rounded-full h-3 mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.4},children:e.jsx(c.div,{className:"h-3 rounded-full "+(t>=90?"bg-gradient-to-r from-yellow-400 to-yellow-500":t>=80?"bg-gradient-to-r from-green-400 to-green-500":t>=70?"bg-gradient-to-r from-blue-400 to-blue-500":t>=60?"bg-gradient-to-r from-orange-400 to-orange-500":"bg-gradient-to-r from-gray-400 to-gray-500"),initial:{width:0},animate:{width:`${t}%`},transition:{duration:1.5,delay:1.6,ease:"easeOut"}})}),e.jsxs(c.div,{className:"flex justify-between text-sm text-gray-500",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.8},children:[e.jsxs("span",{children:["Score: ",t,"%"]}),e.jsxs("span",{children:["Questions: ",n]})]}),e.jsx(c.div,{className:"mt-4 text-xs text-gray-400",initial:{opacity:0},animate:{opacity:1},transition:{delay:2},children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse"}),e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}}),e.jsx("span",{className:"ml-2",children:"Click anywhere to continue..."})]})})]})]}):null;var N},m=({isOpen:n,onClose:o,assessment:c,onComplete:m})=>{var u,x;const[p,h]=r.useState(0),[g,f]=r.useState({}),[y,b]=r.useState(0),[j,N]=r.useState(!1),[w,v]=r.useState(!1),[A,C]=r.useState([]),[k,_]=r.useState(!1),[S,q]=r.useState(null),[T,I]=r.useState(null),[R,M]=r.useState(!1),[E,$]=r.useState(0);r.useEffect(()=>{n&&(null==c?void 0:c.id)&&(async()=>{if(null==c?void 0:c.id){_(!0),q(null);try{console.log("üîç Fetching questions for assessment:",c.id);const e=await l.getAssessmentQuestions(c.id);if(e&&e.length>0){console.log("‚úÖ Questions fetched successfully:",e.length),console.log("üìä Question structure:",e),console.log("üìä First question:",e[0]);const s=e.map(e=>{const s=e.question_type||e.type;let t=[];if(e.options)if("string"==typeof e.options)try{t=JSON.parse(e.options)}catch(n){console.warn("Failed to parse options JSON:",e.options),t=[]}else Array.isArray(e.options)&&(t=e.options);"true-false"!==s&&"true_false"!==s||(t=["True","False"]);let r=[];if(e.correct_answers)if("string"==typeof e.correct_answers)try{r=JSON.parse(e.correct_answers)}catch(n){console.warn("Failed to parse correct_answers JSON:",e.correct_answers),r=[]}else Array.isArray(e.correct_answers)&&(r=e.correct_answers);return{id:e.id,question:e.question_text||e.question,type:s,options:t,correctAnswer:e.correct_answer||e.correctAnswer,correctAnswers:r,explanation:e.explanation,points:e.points||1,wordLimit:e.word_limit,timeLimit:e.time_limit,codeLanguage:e.code_language,codeTemplate:e.code_template,testCases:e.test_cases,fileTypes:e.file_types,maxFileSize:e.max_file_size,allowedExtensions:e.allowed_extensions,blankPositions:e.blank_positions,richTextContent:e.rich_text_content,mediaFiles:e.media_files}});console.log("üìä Transformed questions:",s),s.forEach((e,s)=>{var t;console.log(`üîç Question ${s+1} debug:`,{id:e.id,question:e.question,type:e.type,options:e.options,hasOptions:!!e.options,isArray:Array.isArray(e.options),optionsLength:null==(t=e.options)?void 0:t.length,optionsType:typeof e.options})}),C(s)}else console.warn("‚ö†Ô∏è No questions found for this assessment"),q("No questions found for this assessment")}catch(e){console.error("‚ùå Error fetching questions:",e),q("Failed to load questions")}finally{_(!1)}}})()},[n,null==c?void 0:c.id]);const O=[{id:"1",question:"What is the primary purpose of React Hooks?",type:"multiple-choice",options:["To replace class components entirely","To allow state and lifecycle features in function components","To improve performance of React applications","To handle routing in React applications"],correctAnswer:"To allow state and lifecycle features in function components",explanation:"React Hooks were introduced to allow function components to use state and other React features that were previously only available in class components.",points:4},{id:"2",question:"Which hook is used for side effects in React?",type:"multiple-choice",options:["useState","useEffect","useContext","useReducer"],correctAnswer:"useEffect",explanation:"useEffect is used to perform side effects in function components, such as data fetching, subscriptions, or manually changing the DOM.",points:3},{id:"3",question:"React components must return a single root element.",type:"true-false",options:["True","False"],correctAnswer:"False",explanation:"With React Fragments or array returns, components can return multiple elements without a single root element.",points:2},{id:"4",question:"What does the dependency array in useEffect control?",type:"short-answer",correctAnswer:"when the effect runs",explanation:"The dependency array controls when the useEffect hook runs. If empty, it runs once after mount. If it contains values, it runs when those values change.",points:5},{id:"5",question:"Which of the following is NOT a valid way to create a React component?",type:"multiple-choice",options:["Function declaration","Arrow function","Class component","Object literal"],correctAnswer:"Object literal",explanation:"React components must be either functions or classes. Object literals cannot be used to create React components.",points:3}];r.useEffect(()=>{if(n&&c){const e=c.duration.match(/(\d+)/),s=e?parseInt(e[1]):30;b(60*s),h(0),f({}),N(!1),v(!1),F()}},[n,c]);const F=async()=>{if(null==c?void 0:c.id)try{const e=await s.getCurrentUser();if(!e)return void console.warn("‚ö†Ô∏è No user found for attempt tracking");console.log("üéØ Starting assessment attempt for:",c.id,"student:",e.id);const{data:r,error:n}=await t.rpc("start_assessment_attempt",{p_student_id:e.id,p_assessment_id:c.id});if(n){if(console.error("‚ùå RPC function failed:",n),n.message&&n.message.includes("Maximum attempts exceeded")){console.warn("‚ö†Ô∏è Maximum attempts exceeded, using existing attempt");const{data:s}=await t.from("assessment_attempts").select("id").eq("student_id",e.id).eq("assessment_id",c.id).order("created_at",{ascending:!1}).limit(1).single();if(s)return I(s.id),void console.log("‚úÖ Using existing attempt:",s.id)}const{data:s,error:r}=await t.from("assessment_attempts").insert({student_id:e.id,assessment_id:c.id,attempt_number:1,status:"in-progress",started_at:(new Date).toISOString()}).select("id").single();if(r){if(console.error("‚ùå Direct insert also failed:",r),"23505"===r.code){console.log("üîÑ Duplicate key error, looking for existing attempt...");const{data:s}=await t.from("assessment_attempts").select("id").eq("student_id",e.id).eq("assessment_id",c.id).order("created_at",{ascending:!1}).limit(1).single();if(s)return I(s.id),void console.log("‚úÖ Using existing attempt:",s.id)}const s=`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return I(s),void console.log("‚ö†Ô∏è Using temporary attempt ID:",s)}I(s.id),console.log("‚úÖ Assessment attempt started via direct insert:",s.id)}else I(r),console.log("‚úÖ Assessment attempt started via RPC:",r)}catch(e){console.error("‚ùå Error starting assessment attempt:",e);const s=`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;I(s),console.log("‚ö†Ô∏è Using temporary attempt ID due to error:",s)}else console.warn("‚ö†Ô∏è No assessment ID available for attempt tracking")};r.useEffect(()=>{let e;return n&&y>0&&!j&&(e=setTimeout(()=>{b(e=>e<=1?(D(),0):e-1)},1e3)),()=>clearTimeout(e)},[y,n,j]);const P=(e,s)=>{Array.isArray(s)&&0===s.length?f(s=>{const t={...s};return delete t[e],t}):"string"==typeof s&&""===s.trim()?f(s=>{const t={...s};return delete t[e],t}):f(t=>({...t,[e]:s}))},D=()=>{N(!0),setTimeout(()=>{Q()},1e3)},L=()=>{let e=0,s=0;(A.length>0?A:O).forEach(t=>{var r;e+=t.points;const n=g[t.id];if(!n||"{}"===n||Array.isArray(n)&&0===n.length)console.log("‚ö†Ô∏è No answer provided for question:",t.id);else if(console.log("üîç Checking question:",{id:t.id,question:t.question,type:t.type,userAnswer:n,userAnswerType:typeof n,userAnswerIsArray:Array.isArray(n),correctAnswer:t.correctAnswer,correctAnswers:t.correctAnswers,options:t.options}),"multiple-select"===t.type){const e=Array.isArray(n)?n:[];let r=[],a=[];if(Array.isArray(t.correctAnswers)&&t.correctAnswers.length>0)a=t.correctAnswers,r=a.map(e=>{var s;return null==(s=t.options)?void 0:s[parseInt(e)]}).filter(Boolean);else if(t.correctAnswer){const e=t.correctAnswer.split(",").map(e=>e.trim()).filter(e=>""!==e);a=e,r=e.map(e=>{var s;return null==(s=t.options)?void 0:s[parseInt(e)]}).filter(Boolean)}console.log("üîç Multiple-select debug:",{questionId:t.id,userAnswers:e,correctAnswers:r,correctIndices:a,questionCorrectAnswer:t.correctAnswer,questionCorrectAnswers:t.correctAnswers,options:t.options});const i=r.length>0&&r.every(s=>e.includes(s)),l=e.every(e=>r.includes(e));i&&l?(s+=t.points,console.log("‚úÖ Multiple-select correct:",{userAnswers:e,correctAnswers:r,correctIndices:a})):console.log("‚ùå Multiple-select incorrect:",{userAnswers:e,correctAnswers:r,correctIndices:a})}else if("short-answer"===t.type){const e=String(n||"").trim().toLowerCase(),r=String(t.correctAnswer||"").trim().toLowerCase(),a=e.split(/\s+/),i=r.split(/\s+/),l=e.includes(r)||r.includes(e),o=a.filter(e=>i.includes(e)),c=i.length>0?o.length/i.length:0;l||c>=.5?(s+=t.points,console.log("‚úÖ Short answer correct:",{userAnswer:e,correctAnswer:r,containsMatch:l,wordMatchRatio:c,matchingWords:o.length,totalWords:i.length})):console.log("‚ùå Short answer incorrect:",{userAnswer:e,correctAnswer:r,containsMatch:l,wordMatchRatio:c,matchingWords:o.length,totalWords:i.length})}else{const e=String(n||"").trim().toLowerCase(),a=parseInt(t.correctAnswer||""),i=!isNaN(a)&&(null==(r=t.options)?void 0:r[a])?t.options[a].toLowerCase():String(t.correctAnswer||"").trim().toLowerCase();e===i?(s+=t.points,console.log("‚úÖ Answer correct:",{userAnswer:e,correctAnswer:i,correctAnswerIndex:a,isIndexBased:!isNaN(a)})):console.log("‚ùå Answer incorrect:",{userAnswer:e,correctAnswer:i,correctAnswerIndex:a,isIndexBased:!isNaN(a)})}});return{score:Math.round(s/e*100),totalPoints:e,earnedPoints:s}},Q=()=>{const{score:e}=L();m(e,g),o()},z=()=>Object.keys(g).length,B=A.length>0?A:O,U=B[p],W=(p+1)/B.length*100;return console.log("üîç Current question index:",p),console.log("üîç Total questions:",B.length),console.log("üîç Current question:",U),console.log("üîç All questions:",B),c?U?e.jsxs(e.Fragment,{children:[e.jsx(i,{isOpen:n,onClose:o,title:`${c.title} - ${c.type}`,size:"xl",children:j?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-loader-4-line text-2xl text-blue-600 animate-spin"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Submitting Assessment"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we process your answers..."})]}):k?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-loader-4-line text-2xl text-blue-600 animate-spin"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Assessment"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we load the questions..."})]}):S?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-2xl text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Assessment"}),e.jsx("p",{className:"text-gray-600 mb-4",children:S}),e.jsx(a,{onClick:o,variant:"outline",children:"Close"})]}):0===B.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-question-line text-2xl text-yellow-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Questions Available"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"This assessment doesn't have any questions yet."}),e.jsx(a,{onClick:o,variant:"outline",children:"Close"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Question ",p+1," of ",B.length]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Answered: ",z(),"/",B.length]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-mono "+(y<300?"text-red-600":"text-gray-900"),children:(G=y,`${Math.floor(G/60)}:${(G%60).toString().padStart(2,"0")}`)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Time remaining"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${W}%`}})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 flex-1",children:U.question}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded-full ml-4",children:[U.points," pts"]})]}),e.jsxs("div",{className:"space-y-3",children:["multiple-choice"===U.type&&U.options&&Array.isArray(U.options)&&e.jsx("div",{className:"space-y-2",children:U.options.map((s,t)=>e.jsxs("label",{className:"flex items-center p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-300 cursor-pointer transition-colors",children:[e.jsx("input",{type:"radio",name:`question-${U.id}`,value:s,checked:g[U.id]===s,onChange:e=>P(U.id,e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-3 text-gray-900",children:s})]},t))}),"true-false"===U.type&&(console.log("üîç Rendering true/false options:",{type:U.type,options:U.options,hasOptions:!!U.options,optionsLength:null==(Y=U.options)?void 0:Y.length}),e.jsx("div",{className:"flex space-x-4",children:(U.options||["True","False"]).map(s=>e.jsxs("label",{className:"flex items-center p-4 bg-white rounded-lg border border-gray-200 hover:border-blue-300 cursor-pointer transition-colors flex-1 justify-center",children:[e.jsx("input",{type:"radio",name:`question-${U.id}`,value:s,checked:g[U.id]===s,onChange:e=>P(U.id,e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-3 font-medium text-gray-900",children:s})]},s))})),"short-answer"===U.type&&e.jsx("textarea",{value:g[U.id]||"",onChange:e=>P(U.id,e.target.value),placeholder:"Type your answer here...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4}),"multiple-select"===U.type&&U.options&&Array.isArray(U.options)&&e.jsx("div",{className:"space-y-2",children:U.options.map((s,t)=>{var r;return e.jsxs("label",{className:"flex items-center p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-300 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",name:`question-${U.id}`,value:s,checked:(null==(r=g[U.id])?void 0:r.includes(s))||!1,onChange:e=>{const t=Array.isArray(g[U.id])?g[U.id]:[];e.target.checked?P(U.id,[...t,s]):P(U.id,t.filter(e=>e!==s))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-3 text-gray-900",children:s})]},t)})}),"essay"===U.type&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:g[U.id]||"",onChange:e=>P(U.id,e.target.value),placeholder:"Write your detailed response here...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:8}),U.wordLimit&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Word limit: ",U.wordLimit," words"]})]}),"coding-challenge"===U.type&&e.jsxs("div",{className:"space-y-4",children:[U.codeTemplate&&e.jsx("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm",children:e.jsx("pre",{children:U.codeTemplate})}),e.jsx("textarea",{value:g[U.id]||"",onChange:e=>P(U.id,e.target.value),placeholder:`Write your ${U.codeLanguage||"code"} solution here...`,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",rows:10}),U.timeLimit&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Time limit: ",U.timeLimit," minutes"]})]}),"file-upload"===U.type&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",onChange:e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];t&&P(U.id,t.name)},accept:null==(u=U.allowedExtensions)?void 0:u.join(","),className:"hidden",id:`file-upload-${U.id}`}),e.jsxs("label",{htmlFor:`file-upload-${U.id}`,className:"cursor-pointer flex flex-col items-center",children:[e.jsx("i",{className:"ri-upload-line text-4xl text-gray-400 mb-2"}),e.jsx("span",{className:"text-gray-600",children:"Click to upload file"}),U.allowedExtensions&&e.jsxs("span",{className:"text-sm text-gray-500 mt-1",children:["Allowed: ",U.allowedExtensions.join(", ")]}),U.maxFileSize&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Max size: ",(U.maxFileSize/1024/1024).toFixed(1),"MB"]})]})]}),g[U.id]&&e.jsxs("div",{className:"text-sm text-green-600",children:["Selected: ",g[U.id]]})]}),"fill-in-blanks"===U.type&&e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"text-gray-700 leading-relaxed",children:null==(x=U.blankPositions)?void 0:x.map((s,t)=>e.jsxs("span",{children:[s.before,e.jsx("input",{type:"text",value:g[`${U.id}_${t}`]||"",onChange:e=>P(`${U.id}_${t}`,e.target.value),className:"inline-block mx-1 px-2 py-1 border-b-2 border-blue-500 bg-blue-50 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"___"}),s.after]},t))})})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsxs(a,{variant:"outline",onClick:()=>{p>0&&h(e=>e-1)},disabled:0===p,children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-2",children:B.map((s,t)=>e.jsx("button",{onClick:()=>h(t),className:"w-8 h-8 rounded-full text-sm font-medium transition-colors "+(t===p?"bg-blue-600 text-white":g[B[t].id]?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:t+1},t))}),p===B.length-1?e.jsxs(a,{onClick:()=>{v(!0)},children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Submit Assessment"]}):e.jsxs(a,{onClick:()=>{const e=A.length>0?A:O;p<e.length-1&&h(e=>e+1)},children:["Next",e.jsx("i",{className:"ri-arrow-right-line ml-2"})]})]})]})}),e.jsx(i,{isOpen:w,onClose:()=>v(!1),title:"Submit Assessment",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-alert-line text-yellow-600 mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Are you sure you want to submit?"}),e.jsxs("p",{children:["You have answered ",z()," out of ",A.length," questions."]}),e.jsx("p",{className:"mt-1",children:"Once submitted, you cannot change your answers."})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(a,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsxs(a,{onClick:async()=>{var e,r;v(!1),N(!0);try{const{score:a,totalPoints:i}=L();if(console.log("üìä Calculated score:",a,"out of",i),T){const s=Math.floor((c.duration?60*parseInt((null==(e=c.duration.match(/(\d+)/))?void 0:e[1])||"30"):1800-y)/60);console.log("üíæ Saving attempt to database:",{attemptId:T,score:a,answers:g,timeSpent:s});const{error:r}=await t.rpc("complete_assessment_attempt",{p_attempt_id:T,p_score:a,p_answers:g,p_time_spent:s});if(r){console.error("‚ùå Error completing assessment attempt:",r);const{error:e}=await t.from("assessment_attempts").update({completed_at:(new Date).toISOString(),score:a,answers:g,time_spent:s,status:"completed"}).eq("id",T);e?(console.error("‚ùå Direct update also failed:",e),console.log("‚ö†Ô∏è Assessment attempt could not be saved to database, but score was calculated")):console.log("‚úÖ Assessment attempt completed via direct update")}else console.log("‚úÖ Assessment attempt completed successfully")}else console.warn("‚ö†Ô∏è No attempt ID found, cannot save to database");try{const e=await s.getCurrentUser();if(e){const{data:s,error:t}=await l.saveAssessmentResult({student_id:e.id,assessment_id:c.id,attempt_id:T,score:a,total_points:i,answers:g,feedback:`Completed in ${Math.floor((c.duration?60*parseInt((null==(r=c.duration.match(/(\d+)/))?void 0:r[1])||"30"):1800-y)/60)} minutes`});t?console.error("‚ùå Could not save to assessment_results:",t):console.log("‚úÖ Assessment result saved to assessment_results table:",s)}}catch(n){console.error("‚ùå Could not save to assessment_results:",n)}$(a),M(!0)}catch(a){console.error("‚ùå Error submitting assessment:",a),N(!1)}},children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Submit Now"]})]})]})}),e.jsx(d,{isOpen:R,score:E,totalQuestions:A.length||O.length,onComplete:()=>{M(!1),N(!1),Q()}})]}):(console.error("‚ùå Current question is undefined!",{currentQuestionIndex:p,currentQuestionsLength:B.length,currentQuestions:B}),e.jsx(i,{isOpen:n,onClose:o,title:"Assessment Error",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-4xl"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Question Loading Error"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["There was an issue loading question ",p+1," of ",B.length,"."]}),e.jsx(a,{onClick:o,children:"Close Assessment"})]})})):null;var Y,G},u=({isOpen:s,onClose:n,assessment:o,onRetake:c})=>{const[d,m]=r.useState("overview"),[u,x]=r.useState(null),[p,h]=r.useState(!1),[g,f]=r.useState(null);r.useEffect(()=>{(async()=>{var e;if((null==o?void 0:o.id)&&s){h(!0),f(null);try{console.log("üîç Fetching assessment results for:",o.id);const{data:{user:s}}=await t.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:r,error:n}=await t.from("assessments").select("\n            *,\n            course:courses(*),\n            instructor:profiles!instructor_id(*)\n          ").eq("id",o.id).single();if(n)throw new Error(`Failed to fetch assessment: ${n.message}`);const{data:a,error:i}=await t.from("assessment_attempts").select("*").eq("assessment_id",o.id).eq("student_id",s.id).order("started_at",{ascending:!1}).limit(1).single();i&&"PGRST116"!==i.code&&console.log("‚ö†Ô∏è No attempt data found, using fallback");const{data:c,error:d}=await t.from("assessment_results").select("*").eq("assessment_id",o.id).eq("student_id",s.id).order("completed_at",{ascending:!1}).limit(1).single();d&&"PGRST116"!==d.code&&console.log("‚ö†Ô∏è No result data found, using fallback");const m=await l.getAssessmentQuestions(o.id);if(!m||0===m.length)throw new Error("No questions found for this assessment");let u={};(null==a?void 0:a.answers)?u="string"==typeof a.answers?JSON.parse(a.answers):a.answers:(null==c?void 0:c.answers)&&(u="string"==typeof c.answers?JSON.parse(c.answers):c.answers),console.log("üîç Parsed user answers:",u);const p=m.map(e=>{const s=u[e.id],t=e.question_type||e.type;let r=[];if(e.options)if("string"==typeof e.options)try{r=JSON.parse(e.options)}catch(a){r=[]}else Array.isArray(e.options)&&(r=e.options);"true-false"!==t&&"true_false"!==t||(r=["True","False"]);let n=!1;if(s)if(console.log("üîç Comparing answers:",{questionId:e.id,questionText:e.question_text,userAnswer:s,correctAnswer:e.correct_answer,questionType:t,userAnswerType:typeof s,correctAnswerType:typeof e.correct_answer}),"multiple-select"===t||"multiple_select"===t){const t=Array.isArray(s)?s:[];let a=[],i=[];if(e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0)i=e.correct_answers,a=i.map(e=>r[parseInt(e)]).filter(Boolean);else if(e.correct_answer){const s=e.correct_answer.split(",").map(e=>e.trim()).filter(e=>""!==e);i=s,a=s.map(e=>r[parseInt(e)]).filter(Boolean)}const l=a.length>0&&a.every(e=>t.includes(e)),o=t.every(e=>a.includes(e));n=l&&o,console.log("üîç Multiple-select comparison:",{userAnswers:t,correctAnswers:a,correctIndices:i,allCorrectSelected:l,noIncorrectSelected:o,isCorrect:n})}else if("short-answer"===t||"short_answer"===t){const t=String(s).trim().toLowerCase(),r=String(e.correct_answer||"").trim().toLowerCase(),a=t.includes(r)||r.includes(t),i=t.split(/\s+/),l=r.split(/\s+/),o=i.filter(e=>l.includes(e)),c=l.length>0?o.length/l.length:0;n=a||c>=.5}else{const t=String(s||"").trim().toLowerCase(),a=parseInt(e.correct_answer||""),i=!isNaN(a)&&(null==r?void 0:r[a])?r[a].toLowerCase():String(e.correct_answer||"").trim().toLowerCase();n=t===i,console.log("üîç Single answer comparison:",{userAnswerText:t,correctAnswerText:i,correctAnswerIndex:a,isIndexBased:!isNaN(a),isCorrect:n})}else console.log("‚ùå No user answer provided for question:",e.id);return{id:e.id,question:e.question_text||e.question,type:t,options:r,correctAnswer:e.correct_answer,userAnswer:s,explanation:e.explanation,points:e.points||1,isCorrect:n}}),h=p.reduce((e,s)=>e+s.points,0),g=p.reduce((e,s)=>e+(s.isCorrect?s.points:0),0),f=h>0?Math.round(g/h*100):0;let y="Unknown";if(null==a?void 0:a.time_spent){const e=Math.floor(a.time_spent/60);y=`${e}:${(a.time_spent%60).toString().padStart(2,"0")}`}else if((null==a?void 0:a.started_at)&&(null==a?void 0:a.completed_at)){const e=new Date(a.started_at),s=new Date(a.completed_at).getTime()-e.getTime(),t=Math.floor(s/6e4);y=`${t}:${Math.floor(s%6e4/1e3).toString().padStart(2,"0")}`}const b={id:o.id,title:r.title,course:(null==(e=r.course)?void 0:e.title)||"General Assessment",type:r.type||"Quiz",score:(null==c?void 0:c.score)||f,totalPoints:h,earnedPoints:g,duration:r.time_limit_minutes?`${r.time_limit_minutes} mins`:"No limit",completedAt:(null==c?void 0:c.completed_at)||(null==a?void 0:a.completed_at)||(new Date).toISOString(),timeSpent:y,questions:p,feedback:(null==c?void 0:c.feedback)||(f>=90?"Excellent work! You have a strong understanding of the concepts.":f>=70?"Good job! Review the areas you missed for better understanding.":"Keep practicing! Focus on the fundamental concepts and try again."),recommendations:f<70?["Review the fundamental concepts","Practice with similar questions","Focus on areas where you made mistakes"]:[]};console.log("‚úÖ Assessment results fetched successfully:",b),x(b)}catch(r){console.error("‚ùå Error fetching assessment results:",r),f(r instanceof Error?r.message:"Failed to fetch assessment results")}finally{h(!1)}}})()},[null==o?void 0:o.id,s]);const y={id:(null==o?void 0:o.id)||"1",title:(null==o?void 0:o.title)||"React Hooks and State Management",course:(null==o?void 0:o.course)||"Advanced React Development",type:(null==o?void 0:o.type)||"Practice",score:parseInt((null==o?void 0:o.score)||"87"),totalPoints:17,earnedPoints:15,duration:"45 mins",completedAt:"2024-01-20 14:30",timeSpent:"38 mins",questions:[{id:"1",question:"What is the primary purpose of React Hooks?",type:"multiple-choice",options:["To replace class components entirely","To allow state and lifecycle features in function components","To improve performance of React applications","To handle routing in React applications"],correctAnswer:"To allow state and lifecycle features in function components",userAnswer:"To allow state and lifecycle features in function components",explanation:"React Hooks were introduced to allow function components to use state and other React features that were previously only available in class components.",points:4,isCorrect:!0},{id:"2",question:"Which hook is used for side effects in React?",type:"multiple-choice",options:["useState","useEffect","useContext","useReducer"],correctAnswer:"useEffect",userAnswer:"useEffect",explanation:"useEffect is used to perform side effects in function components, such as data fetching, subscriptions, or manually changing the DOM.",points:3,isCorrect:!0},{id:"3",question:"React components must return a single root element.",type:"true-false",options:["True","False"],correctAnswer:"False",userAnswer:"True",explanation:"With React Fragments or array returns, components can return multiple elements without a single root element.",points:2,isCorrect:!1},{id:"4",question:"What does the dependency array in useEffect control?",type:"short-answer",correctAnswer:"when the effect runs",userAnswer:"when the effect executes",explanation:"The dependency array controls when the useEffect hook runs. If empty, it runs once after mount. If it contains values, it runs when those values change.",points:5,isCorrect:!0},{id:"5",question:"Which of the following is NOT a valid way to create a React component?",type:"multiple-choice",options:["Function declaration","Arrow function","Class component","Object literal"],correctAnswer:"Object literal",userAnswer:"Class component",explanation:"React components must be either functions or classes. Object literals cannot be used to create React components.",points:3,isCorrect:!1}],feedback:"Great understanding of React Hooks! Focus more on performance optimization patterns and component architecture.",recommendations:["Review React Fragments and multiple element returns","Practice with more complex useEffect scenarios","Study component creation patterns and best practices"]},b=u||y,j=b.questions.filter(e=>e.isCorrect).length,N=b.questions.length-j;return o?p?e.jsx(i,{isOpen:s,onClose:n,title:"Assessment Results",size:"xl",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading assessment results..."})]})})}):g?e.jsx(i,{isOpen:s,onClose:n,title:"Assessment Results",size:"xl",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-4xl"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Results"}),e.jsx("p",{className:"text-gray-600 mb-4",children:g}),e.jsxs(a,{onClick:n,variant:"outline",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to Assessments"]})]})}):e.jsx(i,{isOpen:s,onClose:n,title:"Assessment Results",size:"xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center pb-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:b.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:b.course}),e.jsx("div",{className:`inline-flex items-center justify-center w-24 h-24 rounded-full ${w=b.score,w>=90?"bg-green-100":w>=70?"bg-yellow-100":"bg-red-100"} mb-4`,children:e.jsxs("span",{className:`text-3xl font-bold ${(e=>e>=90?"text-green-600":e>=70?"text-yellow-600":"text-red-600")(b.score)}`,children:[b.score,"%"]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[b.earnedPoints,"/",b.totalPoints]}),e.jsx("div",{className:"text-gray-600",children:"Points"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[j,"/",b.questions.length]}),e.jsx("div",{className:"text-gray-600",children:"Correct"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-gray-900",children:b.timeSpent}),e.jsx("div",{className:"text-gray-600",children:"Time Spent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-gray-900",children:b.completedAt.split(" ")[0]}),e.jsx("div",{className:"text-gray-600",children:"Completed"})]})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[{key:"overview",label:"Overview",icon:"ri-dashboard-line"},{key:"questions",label:"Questions",icon:"ri-question-line"},{key:"feedback",label:"Feedback",icon:"ri-chat-3-line"}].map(s=>e.jsxs("button",{onClick:()=>m(s.key),className:"flex items-center px-4 py-2 rounded-md text-sm font-medium transition-colors cursor-pointer flex-1 justify-center "+(d===s.key?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[e.jsx("i",{className:`${s.icon} mr-2`}),s.label]},s.key))}),e.jsxs("div",{className:"min-h-[400px]",children:["overview"===d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Breakdown"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Correct Answers"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:j})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:j/b.questions.length*100+"%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Incorrect Answers"}),e.jsx("span",{className:"text-sm font-medium text-red-600",children:N})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-500 h-2 rounded-full",style:{width:N/b.questions.length*100+"%"}})})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Question Type Performance"}),e.jsx("div",{className:"space-y-4",children:(()=>{const s=[...new Set(b.questions.map(e=>e.type))],t={"multiple-choice":{label:"Multiple Choice",icon:"ri-checkbox-line",color:"bg-blue-500"},"multiple-select":{label:"Multiple Select",icon:"ri-checkbox-multiple-line",color:"bg-purple-500"},"true-false":{label:"True/False",icon:"ri-toggle-line",color:"bg-green-500"},"short-answer":{label:"Short Answer",icon:"ri-pencil-line",color:"bg-orange-500"},essay:{label:"Essay",icon:"ri-file-text-line",color:"bg-indigo-500"},"coding-challenge":{label:"Coding Challenge",icon:"ri-code-line",color:"bg-red-500"},"file-upload":{label:"File Upload",icon:"ri-upload-line",color:"bg-teal-500"},"fill-in-blanks":{label:"Fill in the Blanks",icon:"ri-edit-line",color:"bg-pink-500"}};return s.map(s=>{const r=b.questions.filter(e=>e.type===s),n=r.filter(e=>e.isCorrect).length,a=r.length>0?Math.round(n/r.length*100):0,i=t[s]||{label:s.replace("-"," ").replace("_"," "),icon:"ri-question-line",color:"bg-gray-500"};return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 ${i.color} rounded-full mr-3`}),e.jsx("i",{className:`${i.icon} text-gray-600 mr-2`}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:i.label})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[n,"/",r.length]}),e.jsxs("span",{className:"text-sm font-medium "+(a>=70?"text-green-600":"text-red-600"),children:[a,"%"]})]})]},s)})})()})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Time Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:b.timeSpent}),e.jsx("div",{className:"text-sm text-gray-600",children:"Time Spent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:b.duration}),e.jsx("div",{className:"text-sm text-gray-600",children:"Time Allowed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(()=>{if("Unknown"!==b.timeSpent&&"No limit"!==b.duration){const e=b.timeSpent.includes(":")?parseInt(b.timeSpent.split(":")[0]):parseInt(b.timeSpent),s=parseInt(b.duration);return`${Math.max(0,s-e)} mins`}return"Unknown"})()}),e.jsx("div",{className:"text-sm text-gray-600",children:"Time Saved"})]})]})]})]}),"questions"===d&&e.jsx("div",{className:"space-y-4",children:b.questions.map((s,t)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900 flex-1",children:[t+1,". ",s.question]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(s.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.isCorrect?"Correct":"Incorrect"}),e.jsxs("span",{className:"text-xs text-gray-600",children:[s.points," pts"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[("multiple-choice"===s.type||"multiple_choice"===s.type)&&s.options&&e.jsx("div",{className:"space-y-2",children:s.options.map((t,r)=>{let n="";if(s.correctAnswer){const e=parseInt(s.correctAnswer);n=isNaN(e)?s.correctAnswer:s.options[e]||""}const a=t===n,i=t===s.userAnswer;return e.jsx("div",{className:"p-2 rounded border text-sm "+(a?"bg-green-100 border-green-300 text-green-800":i&&!s.isCorrect?"bg-red-100 border-red-300 text-red-800":"bg-white border-gray-200 text-gray-700"),children:e.jsxs("div",{className:"flex items-center",children:[a&&e.jsx("i",{className:"ri-check-line text-green-600 mr-2"}),i&&!s.isCorrect&&e.jsx("i",{className:"ri-close-line text-red-600 mr-2"}),e.jsx("span",{children:t}),i&&e.jsx("span",{className:"ml-auto text-xs font-medium",children:"Your Answer"})]})},r)})}),("true-false"===s.type||"true_false"===s.type)&&e.jsx("div",{className:"flex space-x-4",children:["True","False"].map((t,r)=>{let n="";if(s.correctAnswer){const e=parseInt(s.correctAnswer);if(isNaN(e)){const e=s.correctAnswer.toLowerCase().trim();n="true"===e||"false"===e?e.charAt(0).toUpperCase()+e.slice(1):"0"===e||"1"===e?"0"===e?"True":"False":s.correctAnswer}else n=["True","False"][e]||""}const a=t===n,i=t===s.userAnswer;return console.log("üîç True/False Debug:",{option:t,correctAnswerText:n,questionCorrectAnswer:s.correctAnswer,isCorrectAnswer:a,isUserAnswer:i,userAnswer:s.userAnswer}),e.jsxs("div",{className:"p-2 rounded border text-sm flex-1 text-center "+(a?"bg-green-100 border-green-300 text-green-800":i&&!s.isCorrect?"bg-red-100 border-red-300 text-red-800":"bg-white border-gray-200 text-gray-700"),children:[a&&e.jsx("i",{className:"ri-check-line text-green-600 mr-1"}),i&&!s.isCorrect&&e.jsx("i",{className:"ri-close-line text-red-600 mr-1"}),t,i&&e.jsx("span",{className:"ml-2 text-xs font-medium",children:"Your Answer"})]},t)})}),("short-answer"===s.type||"short_answer"===s.type)&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-3 bg-green-100 border border-green-300 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-green-800 mb-1",children:"Correct Answer:"}),e.jsx("div",{className:"text-sm text-green-700",children:s.correctAnswer})]}),e.jsxs("div",{className:"p-3 rounded border "+(s.isCorrect?"bg-green-100 border-green-300":"bg-red-100 border-red-300"),children:[e.jsx("div",{className:"text-xs font-medium mb-1 "+(s.isCorrect?"text-green-800":"text-red-800"),children:"Your Answer:"}),e.jsx("div",{className:"text-sm "+(s.isCorrect?"text-green-700":"text-red-700"),children:s.userAnswer||"No answer provided"})]})]}),("multiple-select"===s.type||"multiple_select"===s.type)&&s.options&&e.jsx("div",{className:"space-y-2",children:s.options.map((t,r)=>{let n=[];if(s.correctAnswer)if("string"==typeof s.correctAnswer){n=s.correctAnswer.split(",").map(e=>e.trim()).map(e=>s.options[parseInt(e)]).filter(Boolean)}else Array.isArray(s.correctAnswer)&&(n=s.correctAnswer);const a=n.includes(t),i=s.userAnswer&&(Array.isArray(s.userAnswer)?s.userAnswer.includes(t):s.userAnswer.includes(r.toString()));return e.jsx("div",{className:"p-2 rounded border text-sm "+(a?"bg-green-100 border-green-300 text-green-800":i&&!s.isCorrect?"bg-red-100 border-red-300 text-red-800":"bg-white border-gray-200 text-gray-700"),children:e.jsxs("div",{className:"flex items-center",children:[a&&e.jsx("i",{className:"ri-check-line text-green-600 mr-2"}),i&&!s.isCorrect&&e.jsx("i",{className:"ri-close-line text-red-600 mr-2"}),e.jsx("span",{children:t}),i&&e.jsx("span",{className:"ml-auto text-xs font-medium",children:"Your Answer"})]})},r)})}),"essay"===s.type&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Model Answer:"}),e.jsx("div",{className:"text-sm text-blue-700",children:s.correctAnswer||"No model answer provided"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-gray-800 mb-2",children:"Your Response:"}),e.jsx("div",{className:"text-sm text-gray-700",children:s.userAnswer||"No response provided"})]}),e.jsxs("div",{className:"text-xs text-gray-600 italic",children:[e.jsx("i",{className:"ri-information-line mr-1"}),"This question requires manual grading by the instructor."]})]}),"coding-challenge"===s.type&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-green-800 mb-2",children:"Expected Solution:"}),e.jsx("pre",{className:"text-sm text-green-700 bg-white p-2 rounded border overflow-x-auto",children:e.jsx("code",{children:s.correctAnswer||"No solution provided"})})]}),e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-gray-800 mb-2",children:"Your Code:"}),e.jsx("pre",{className:"text-sm text-gray-700 bg-white p-2 rounded border overflow-x-auto",children:e.jsx("code",{children:s.userAnswer||"No code submitted"})})]}),e.jsxs("div",{className:"text-xs text-gray-600 italic",children:[e.jsx("i",{className:"ri-information-line mr-1"}),"This question requires manual review by the instructor."]})]}),"file-upload"===s.type&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-green-800 mb-2",children:"Expected File Types:"}),e.jsx("div",{className:"text-sm text-green-700",children:s.correctAnswer||"No specific requirements"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-gray-800 mb-2",children:"Your Upload:"}),e.jsx("div",{className:"text-sm text-gray-700",children:s.userAnswer?e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-file-line mr-2"}),e.jsx("span",{children:s.userAnswer})]}):"No file uploaded"})]}),e.jsxs("div",{className:"text-xs text-gray-600 italic",children:[e.jsx("i",{className:"ri-information-line mr-1"}),"This question requires manual review by the instructor."]})]}),"fill-in-blanks"===s.type&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-green-800 mb-2",children:"Correct Answers:"}),e.jsx("div",{className:"text-sm text-green-700",children:s.correctAnswer?e.jsx("div",{className:"space-y-1",children:s.correctAnswer.split(",").map((s,t)=>e.jsxs("div",{className:"bg-white p-2 rounded border",children:["Blank ",t+1,": ",e.jsx("strong",{children:s.trim()})]},t))}):"No correct answers provided"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:[e.jsx("div",{className:"text-xs font-medium text-gray-800 mb-2",children:"Your Answers:"}),e.jsx("div",{className:"text-sm text-gray-700",children:s.userAnswer?e.jsx("div",{className:"space-y-1",children:Array.isArray(s.userAnswer)?s.userAnswer.map((s,t)=>e.jsxs("div",{className:"bg-white p-2 rounded border",children:["Blank ",t+1,": ",e.jsx("strong",{children:s})]},t)):e.jsx("div",{className:"bg-white p-2 rounded border",children:e.jsx("strong",{children:s.userAnswer})})}):"No answers provided"})]})]}),s.explanation&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-lightbulb-line text-blue-600 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-blue-800 mb-1",children:"Explanation:"}),e.jsx("div",{className:"text-sm text-blue-700",children:s.explanation})]})]})})]})]},s.id))}),"feedback"===d&&e.jsxs("div",{className:"space-y-6",children:[b.feedback&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-chat-3-line text-blue-600 mr-3 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Instructor Feedback"}),e.jsx("p",{className:"text-blue-800",children:b.feedback})]})]})}),b.recommendations&&b.recommendations.length>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-lightbulb-line text-yellow-600 mr-3 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-900 mb-3",children:"Recommendations for Improvement"}),e.jsx("ul",{className:"space-y-2",children:b.recommendations.map((s,t)=>e.jsxs("li",{className:"flex items-start text-yellow-800",children:[e.jsx("i",{className:"ri-arrow-right-s-line text-yellow-600 mr-2 mt-0.5"}),e.jsx("span",{className:"text-sm",children:s})]},t))})]})]})}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-trophy-line text-green-600 mr-3 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-2",children:"Strengths"}),e.jsxs("ul",{className:"space-y-1 text-green-800 text-sm",children:[e.jsx("li",{children:"‚Ä¢ Strong understanding of React Hooks fundamentals"}),e.jsx("li",{children:"‚Ä¢ Good grasp of useEffect and side effects management"}),e.jsx("li",{children:"‚Ä¢ Excellent performance on conceptual questions"})]})]})]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-bookmark-line text-gray-600 mr-3 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Study Resources"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("a",{href:"#",className:"block text-blue-600 hover:text-blue-700 text-sm",children:[e.jsx("i",{className:"ri-external-link-line mr-1"}),"React Fragments Documentation"]}),e.jsxs("a",{href:"#",className:"block text-blue-600 hover:text-blue-700 text-sm",children:[e.jsx("i",{className:"ri-external-link-line mr-1"}),"Advanced useEffect Patterns"]}),e.jsxs("a",{href:"#",className:"block text-blue-600 hover:text-blue-700 text-sm",children:[e.jsx("i",{className:"ri-external-link-line mr-1"}),"Component Creation Best Practices"]})]})]})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t border-gray-200",children:[e.jsxs(a,{variant:"outline",onClick:n,children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to Assessments"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(a,{variant:"outline",children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Download Results"]}),c&&e.jsxs(a,{onClick:c,children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Retake Assessment"]})]})]})]})}):null;var w},x=()=>{const[t,o]=r.useState([]),[c,d]=r.useState([]),[x,p]=r.useState("all"),[h,g]=r.useState("all"),[f,y]=r.useState(!1),[b,j]=r.useState(null),[N,w]=r.useState(!1),[v,A]=r.useState(!1),[C,k]=r.useState(null),[_,S]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const e=await s.getCurrentUser();if(!e)return console.error("User not authenticated"),void S(!1);console.log("üîç Fetching assessments for student:",e.id);const t=await l.getStudentAssessments(e.id),r=await l.getAssessmentResults(),n=[{id:"all",title:"All Courses",assessmentCount:0},...(await l.getEnrollments(e.id)).map(e=>{var s;return{id:e.course_id,title:(null==(s=e.course)?void 0:s.title)||"Unknown Course",assessmentCount:t.filter(s=>s.course_id===e.course_id).length}})];d(n),console.log("üìö Student assessments data:",t),console.log("üìä Student results data:",r),console.log("üéì Student courses:",n);const a=await Promise.all(t.map(async s=>{var t,n;const a=r.find(e=>e.assessment_id===s.id),i=await l.getAssessmentDetails(s.id,e.id);return i?(console.log(`üìä Assessment ${s.title} details:`,{questions:i.questionCount,attempts:i.attempts,maxAttempts:i.maxAttempts,topics:i.topics,feedback:i.feedback}),{id:s.id,title:s.title,course:(null==(n=s.course)?void 0:n.title)||"General Assessment",courseId:s.course_id||"1",type:i.type||"Quiz",duration:i.duration,questions:i.questionCount,status:a?"completed":"upcoming",difficulty:i.difficulty,topics:i.topics,attempts:i.attempts,maxAttempts:i.maxAttempts,dueDate:void 0,score:null==a?void 0:a.score.toString(),maxScore:"100",feedback:i.feedback}):(console.warn(`‚ö†Ô∏è Could not fetch details for assessment ${s.id}`),{id:s.id,title:s.title,course:(null==(t=s.course)?void 0:t.title)||"General Assessment",courseId:s.course_id||"1",type:"Quiz",duration:"30 mins",questions:0,status:a?"completed":"upcoming",difficulty:"Easy",topics:["General Topics"],attempts:0,maxAttempts:3,score:null==a?void 0:a.score.toString(),maxScore:"100",feedback:"Good work!"})}));console.log("‚úÖ Transformed assessments:",a),o(a)}catch(e){console.error("Error fetching assessments:",e)}finally{S(!1)}})()},[]);const q=t.filter(e=>{const s="all"===x||e.courseId===x,t="all"===h||e.status===h;return s&&t}),T=[{label:"Total Assessments",value:t.length.toString(),icon:"ri-file-list-line",color:"blue"},{label:"Completed",value:t.filter(e=>"completed"===e.status).length.toString(),icon:"ri-check-line",color:"green"},{label:"In Progress",value:t.filter(e=>"in-progress"===e.status).length.toString(),icon:"ri-play-line",color:"orange"},{label:"Average Score",value:"89%",icon:"ri-star-line",color:"purple"}],I=e=>{j(e),y(!0)},R=e=>({Easy:"bg-green-100 text-green-800",Medium:"bg-yellow-100 text-yellow-800",Hard:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Assessments"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Practice tests, quizzes, and track your progress"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:T.map((s,t)=>e.jsxs(n,{className:"text-center",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-4 rounded-full bg-${s.color}-100 flex items-center justify-center`,children:e.jsx("i",{className:`${s.icon} text-2xl text-${s.color}-600`})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:s.value}),e.jsx("div",{className:"text-sm text-gray-600",children:s.label})]},t))}),c.length>1&&e.jsxs(n,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Course"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:c.map(s=>e.jsxs("button",{onClick:()=>p(s.id),className:"p-4 rounded-lg border-2 transition-all cursor-pointer text-left "+(x===s.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.title}),"all"!==s.id&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.assessmentCount," assessments"]})]},s.id))})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg w-fit",children:[{key:"all",label:"All"},{key:"upcoming",label:"Upcoming"},{key:"in-progress",label:"In Progress"},{key:"completed",label:"Completed"}].map(s=>e.jsx("button",{onClick:()=>g(s.key),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors cursor-pointer whitespace-nowrap "+(h===s.key?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:s.label},s.key))}),e.jsx("div",{className:"space-y-4",children:q.map(s=>{return e.jsx(n,{className:"hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:s.title}),e.jsx("p",{className:"text-gray-600 mb-2",children:s.course})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t=s.type,{Quiz:"bg-blue-100 text-blue-800",Test:"bg-purple-100 text-purple-800",Practice:"bg-green-100 text-green-800"}[t]||"bg-gray-100 text-gray-800"}`,children:s.type}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${R(s.difficulty)}`,children:s.difficulty})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-time-line mr-2 text-gray-400"}),s.duration]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-question-mark mr-2 text-gray-400"}),s.questions," questions"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-refresh-line mr-2 text-gray-400"}),s.attempts,"/",s.maxAttempts," attempts"]}),s.dueDate&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-calendar-line mr-2 text-gray-400"}),"Due: ",s.dueDate]})]}),s.topics.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Topics covered:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.topics.map((s,t)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-md",children:s},t))})]}),"completed"===s.status&&s.score&&e.jsx("div",{className:"bg-green-50 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Score: "}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[s.score,"%"]})]}),e.jsx("i",{className:"ri-trophy-line text-2xl text-green-600"})]})}),s.feedback&&e.jsx("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-chat-3-line text-blue-600 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-900 mb-1",children:"Instructor Feedback"}),e.jsx("div",{className:"text-sm text-blue-800",children:s.feedback})]})]})})]}),e.jsxs("div",{className:"ml-6 flex flex-col space-y-2",children:["upcoming"===s.status&&e.jsxs(a,{onClick:()=>I(s),children:[e.jsx("i",{className:"ri-play-line mr-2"}),"Start ",s.type]}),"in-progress"===s.status&&e.jsxs(a,{className:"bg-orange-600 hover:bg-orange-700",onClick:()=>I(s),children:[e.jsx("i",{className:"ri-play-line mr-2"}),"Continue"]}),"completed"===s.status&&e.jsxs(a,{variant:"outline",onClick:()=>(e=>{k(e),A(!0)})(s),children:[e.jsx("i",{className:"ri-eye-line mr-2"}),"View Results"]}),e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium text-center "+("upcoming"===s.status?"bg-gray-100 text-gray-800":"in-progress"===s.status?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"),children:"upcoming"===s.status?"Ready":"in-progress"===s.status?"In Progress":"Completed"})]})]})},s.id);var t})}),0===q.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-file-list-line text-2xl text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No assessments found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:0===t.length?"You are not enrolled in any courses with assessments yet. Contact your mentor to get enrolled in courses.":"all"===x?"No assessments match the current filter":"No assessments available for the selected course"}),0===t.length&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-information-line text-blue-600 mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Need help?"}),e.jsx("p",{children:"Contact your mentor to enroll you in courses with assessments."})]})]})})]}),e.jsx(i,{isOpen:f,onClose:()=>{y(!1),j(null)},title:"Start Assessment",children:b&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:b.title}),e.jsx("p",{className:"text-gray-600 mb-3",children:b.course}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Duration:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:b.duration})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Questions:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:b.questions})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Difficulty:"}),e.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${R(b.difficulty)}`,children:b.difficulty})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Attempts left:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:b.maxAttempts-b.attempts})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-alert-line text-yellow-600 mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Important Instructions:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:["You have ",b.duration," to complete this assessment"]}),e.jsx("li",{children:"Make sure you have a stable internet connection"}),e.jsx("li",{children:"Once started, the timer cannot be paused"}),e.jsx("li",{children:"You can save and continue later for practice assessments"})]})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(a,{variant:"outline",onClick:()=>{y(!1),j(null)},children:"Cancel"}),e.jsxs(a,{onClick:()=>{y(!1),w(!0)},children:[e.jsx("i",{className:"ri-play-line mr-2"}),"Start Assessment"]})]})]})}),e.jsx(m,{isOpen:N,onClose:()=>{w(!1),j(null)},assessment:b,onComplete:(e,s)=>{o(s=>s.map(s=>s.id===(null==b?void 0:b.id)?{...s,status:"completed",score:e.toString(),maxScore:"100",attempts:s.attempts+1,feedback:e>=90?"Excellent work! You have a strong understanding of the concepts.":e>=70?"Good job! Review the areas you missed for better understanding.":"Keep practicing! Focus on the fundamental concepts and try again."}:s)),w(!1),j(null)}}),e.jsx(u,{isOpen:v,onClose:()=>{A(!1),k(null)},assessment:C,onRetake:()=>{if(A(!1),C){const e={...C,status:"upcoming"};j(e),w(!0)}}})]})};export{x as default};
