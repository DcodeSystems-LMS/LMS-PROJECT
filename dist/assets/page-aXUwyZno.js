import{a as e,j as s}from"./index-BaWXG3YY.js";import{r as l}from"./vendor-D_DxLZN2.js";import{L as i}from"./router-BbFJyaaj.js";import{C as a}from"./Card-CQri447u.js";import{B as r}from"./Button-lmmCuxjA.js";import{M as t}from"./Modal-C5SmEZl1.js";import{D as c}from"./dataService-M2AFkWLp.js";import"./supabase-DnW1kxsT.js";function n(){var n;const[m,d]=l.useState([]),[x,o]=l.useState(null),[h,j]=l.useState(!1),[u,N]=l.useState(""),[g,f]=l.useState([]),[p,v]=l.useState(!0),[y,b]=l.useState(""),[w,C]=l.useState(null);l.useEffect(()=>{S(),k()},[]);const S=async()=>{try{v(!0),b("");const s=await e.getCurrentUser();if(!s)return void b("Please log in to view your wishlist");C(s),console.log("ðŸ”„ Fetching courses for wishlist...");const l=await c.getCourses();console.log("ðŸ“– All courses:",l),f(l),console.log("âœ… Wishlist data loaded successfully")}catch(s){console.error("âŒ Error loading wishlist data:",s),b("Failed to load courses. Please try again.")}finally{v(!1)}},k=()=>{const e=localStorage.getItem("courseWishlist");e&&d(JSON.parse(e))},E=e=>{localStorage.setItem("courseWishlist",JSON.stringify(e)),d(e)},I=g.filter(e=>m.includes(e.id)),W=async(e,s)=>{if(w)try{console.log("ðŸŽ“ Enrolling in course:",e),await c.enrollInCourse(w.id,e);const s=m.filter(s=>s!==e);E(s),j(!0),setTimeout(()=>j(!1),3e3),console.log("âœ… Successfully enrolled in course")}catch(l){console.error("âŒ Error enrolling in course:",l),b("Failed to enroll in course. Please try again.")}else b("Please log in to enroll in courses")},D=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return p?s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading your wishlist..."})]})})}):y?s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs(a,{className:"text-center",children:[s.jsx("div",{className:"text-red-600 mb-4",children:s.jsx("i",{className:"ri-error-warning-line text-4xl"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Wishlist"}),s.jsx("p",{className:"text-gray-600 mb-4",children:y}),s.jsxs(r,{onClick:S,variant:"outline",children:[s.jsx("i",{className:"ri-refresh-line mr-2"}),"Try Again"]})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Wishlist"}),s.jsxs("p",{className:"mt-2 text-gray-600",children:["Courses you've saved for later. ",I.length," course",1!==I.length?"s":""," saved."]})]}),s.jsx("div",{className:"mt-4 sm:mt-0 flex space-x-3",children:s.jsxs(r,{onClick:S,variant:"outline",children:[s.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]})})]})}),h&&s.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("i",{className:"ri-check-line text-green-400"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Success!"}),s.jsx("div",{className:"mt-2 text-sm text-green-700",children:"You have successfully enrolled in the course!"})]})]})}),u&&s.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("i",{className:"ri-heart-line text-blue-400"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Wishlist Updated"}),s.jsx("div",{className:"mt-2 text-sm text-blue-700",children:u})]})]})}),0===I.length?s.jsxs(a,{className:"text-center py-12",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("i",{className:"ri-heart-line text-6xl"})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Your Wishlist is Empty"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Start exploring courses and add them to your wishlist to save them for later!"}),s.jsx(i,{to:"/student/my-courses",children:s.jsxs(r,{variant:"neon",children:[s.jsx("i",{className:"ri-search-line mr-2"}),"Browse Courses"]})})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map(e=>{var l,i,t;return s.jsxs(a,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"aspect-video bg-gray-200 relative",children:[e.thumbnail?s.jsx("img",{src:e.thumbnail,alt:e.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx("i",{className:"ri-book-open-line text-4xl text-gray-400"})}),s.jsx("div",{className:"absolute top-3 left-3",children:s.jsx("span",{className:"bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium",children:e.level})}),s.jsx("div",{className:"absolute top-3 right-3",children:s.jsx("i",{className:"ri-heart-fill text-red-500 text-xl"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:"mb-3",children:s.jsx("span",{className:"text-sm text-blue-600 font-medium",children:e.category})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:e.description}),s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center mr-3",children:s.jsx("span",{className:"text-xs font-medium text-gray-600",children:e.instructor?(t=e.instructor.name,t.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)):"M"})}),s.jsx("div",{children:s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["by ",(null==(l=e.instructor)?void 0:l.name)||"Mentor"]})})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("i",{className:"ri-time-line mr-1"}),s.jsxs("span",{children:[e.duration_hours,"h"]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("i",{className:"ri-calendar-line mr-1"}),s.jsx("span",{children:(i=e.created_at,new Date(i).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}))})]})]}),s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsx("div",{className:"text-xl font-bold text-gray-900",children:D(e.price)})}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs(r,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>o(e),children:[s.jsx("i",{className:"ri-eye-line mr-1"}),"View Details"]}),s.jsxs(r,{size:"sm",className:"flex-1",onClick:()=>W(e.id,e.title),children:[s.jsx("i",{className:"ri-add-line mr-1"}),"Enroll Now"]})]}),s.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:s.jsxs(r,{variant:"outline",size:"sm",className:"w-full text-red-600 border-red-300 hover:bg-red-50",onClick:()=>((e,s)=>{const l=m.filter(s=>s!==e);E(l),N(`"${s}" removed from wishlist!`),setTimeout(()=>N(""),3e3)})(e.id,e.title),children:[s.jsx("i",{className:"ri-heart-fill mr-2"}),"Remove from Wishlist"]})})]})]},e.id)})}),x&&s.jsx(t,{isOpen:!0,onClose:()=>o(null),title:x.title,size:"lg",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"flex-shrink-0",children:x.thumbnail?s.jsx("img",{className:"h-24 w-32 object-cover rounded-lg",src:x.thumbnail,alt:x.title}):s.jsx("div",{className:"h-24 w-32 bg-gray-200 rounded-lg flex items-center justify-center",children:s.jsx("i",{className:"ri-book-open-line text-2xl text-gray-400"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:x.title}),s.jsx("p",{className:"text-gray-600 mb-3",children:x.description}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"ri-user-line mr-1"}),"by ",(null==(n=x.instructor)?void 0:n.name)||"Mentor"]}),s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"ri-time-line mr-1"}),x.duration_hours," hours"]}),s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"ri-price-tag-3-line mr-1"}),D(x.price)]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Course Information"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Level:"}),s.jsx("span",{className:"font-medium",children:x.level})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Category:"}),s.jsx("span",{className:"font-medium",children:x.category})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Duration:"}),s.jsxs("span",{className:"font-medium",children:[x.duration_hours," hours"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Price:"}),s.jsx("span",{className:"font-medium",children:D(x.price)})]})]})]}),x.objectives&&x.objectives.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Learning Objectives"}),s.jsx("ul",{className:"space-y-1 text-sm",children:x.objectives.map((e,l)=>s.jsxs("li",{className:"flex items-start",children:[s.jsx("i",{className:"ri-check-line text-green-600 mt-1 mr-2"}),s.jsx("span",{className:"text-gray-700",children:e})]},l))})]})]}),x.requirements&&x.requirements.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Requirements"}),s.jsx("ul",{className:"space-y-1 text-sm",children:x.requirements.map((e,l)=>s.jsxs("li",{className:"flex items-start",children:[s.jsx("i",{className:"ri-arrow-right-line text-blue-600 mt-1 mr-2"}),s.jsx("span",{className:"text-gray-700",children:e})]},l))})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[s.jsx(r,{variant:"outline",onClick:()=>o(null),children:"Close"}),s.jsxs(r,{onClick:()=>{W(x.id,x.title),o(null)},children:[s.jsx("i",{className:"ri-add-line mr-2"}),"Enroll Now"]})]})]})})]})})}export{n as default};
