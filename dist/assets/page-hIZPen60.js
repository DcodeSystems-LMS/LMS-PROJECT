import{j as e}from"./index-tBdcIxzk.js";import{r as t}from"./vendor-D_DxLZN2.js";import{C as r}from"./Card-CCr5q94u.js";import{B as s}from"./Button-q_HxaLrT.js";import{D as a}from"./dataService-7pESmbQL.js";import{a as i}from"./router-BPhEMSNK.js";import"./supabase-BMSNwJ-5.js";import"./supabase-DCVaQTjR.js";const l=()=>{const l=i(),[n,c]=t.useState([]),[d,o]=t.useState("all"),[m,x]=t.useState([]);t.useEffect(()=>{(async()=>{try{const e="current-user-id",t=(await a.getNotifications(e)).map(e=>({id:e.id,type:e.type,title:e.title,message:e.message,timestamp:e.created_at,read:e.read,icon:h(e.type),color:u(e.type),actionUrl:void 0,actionText:void 0}));c(t)}catch(e){console.error("Error fetching notifications:",e),c([])}})()},[]);const h=e=>{switch(e){case"achievement":return"ri-medal-line";case"course":return"ri-book-line";case"assessment":return"ri-file-list-line";case"reminder":return"ri-calendar-line";case"mentor":return"ri-user-line";default:return"ri-notification-line"}},u=e=>{switch(e){case"achievement":return"yellow";case"course":return"blue";case"assessment":return"purple";case"reminder":return"green";case"mentor":return"indigo";default:return"gray"}},p=n.filter(e=>"all"===d||("unread"===d?!e.read:"read"===d?e.read:e.type===d)),g=n.filter(e=>!e.read).length,f=e=>{c(t=>t.map(t=>t.id===e?{...t,read:!0}:t))},b=e=>{const t=new Date(e),r=new Date,s=Math.floor((r.getTime()-t.getTime())/36e5);if(s<1){const e=Math.floor((r.getTime()-t.getTime())/6e4);return e<1?"Just now":`${e}m ago`}if(s<24)return`${s}h ago`;{const e=Math.floor(s/24);return 1===e?"Yesterday":e<7?`${e} days ago`:t.toLocaleDateString()}},j=[{key:"all",label:"All",count:n.length},{key:"unread",label:"Unread",count:g},{key:"read",label:"Read",count:n.length-g},{key:"achievement",label:"Achievements",count:n.filter(e=>"achievement"===e.type).length},{key:"course",label:"Courses",count:n.filter(e=>"course"===e.type).length},{key:"assessment",label:"Assessments",count:n.filter(e=>"assessment"===e.type).length},{key:"reminder",label:"Reminders",count:n.filter(e=>"reminder"===e.type).length}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-theme-text-primary",children:"Notifications"}),e.jsx("p",{className:"text-theme-text-secondary mt-1",children:"Stay updated with your learning progress and important updates"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[m.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(s,{variant:"outline",onClick:()=>{c(e=>e.map(e=>m.includes(e.id)?{...e,read:!0}:e)),x([])},className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Mark Read (",m.length,")"]}),e.jsxs(s,{variant:"outline",onClick:()=>{c(e=>e.filter(e=>!m.includes(e.id))),x([])},className:"text-red-600 border-red-600 hover:bg-red-50 whitespace-nowrap",children:[e.jsx("i",{className:"ri-delete-bin-line mr-2"}),"Delete (",m.length,")"]})]}),g>0&&e.jsxs(s,{onClick:()=>{c(e=>e.map(e=>({...e,read:!0})))},className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-check-double-line mr-2"}),"Mark All Read"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(r,{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-notification-line text-2xl text-blue-600"})}),e.jsx("div",{className:"text-2xl font-bold text-theme-text-primary mb-1",children:n.length}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Total"})]}),e.jsxs(r,{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-mail-unread-line text-2xl text-red-600"})}),e.jsx("div",{className:"text-2xl font-bold text-theme-text-primary mb-1",children:g}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Unread"})]}),e.jsxs(r,{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-mail-check-line text-2xl text-green-600"})}),e.jsx("div",{className:"text-2xl font-bold text-theme-text-primary mb-1",children:n.length-g}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Read"})]}),e.jsxs(r,{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-trophy-line text-2xl text-yellow-600"})}),e.jsx("div",{className:"text-2xl font-bold text-theme-text-primary mb-1",children:n.filter(e=>"achievement"===e.type).length}),e.jsx("div",{className:"text-sm text-theme-text-secondary",children:"Achievements"})]})]}),e.jsx(r,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:j.map(t=>e.jsxs("button",{onClick:()=>o(t.key),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all cursor-pointer whitespace-nowrap "+(d===t.key?"bg-brand-primary text-white shadow-sm":"bg-theme-hover-bg text-theme-text-secondary hover:bg-theme-card-bg hover:text-theme-text-primary"),children:[t.label,e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+(d===t.key?"bg-white/20 text-white":"bg-theme-border text-theme-text-tertiary"),children:t.count})]},t.key))})}),e.jsx("div",{className:"space-y-3",children:0===p.length?e.jsxs(r,{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-theme-hover-bg rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-notification-off-line text-2xl text-theme-text-tertiary"})}),e.jsx("h3",{className:"text-lg font-medium text-theme-text-primary mb-2",children:"No notifications found"}),e.jsx("p",{className:"text-theme-text-secondary",children:"all"===d?"You're all caught up! No notifications to show.":`No ${d} notifications found.`})]}):p.map(t=>{return e.jsx(r,{className:`transition-all hover:shadow-md cursor-pointer ${t.read?"":"bg-blue-50/30 dark:bg-blue-900/10 border-l-4 border-l-brand-primary"} ${m.includes(t.id)?"ring-2 ring-brand-primary/50":""}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex items-center pt-1",children:e.jsx("input",{type:"checkbox",checked:m.includes(t.id),onChange:()=>{return e=t.id,void x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]);var e},className:"w-4 h-4 text-brand-primary bg-theme-card-bg border-theme-border rounded focus:ring-brand-primary focus:ring-2 cursor-pointer"})}),e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${a=t.color,{yellow:"bg-yellow-100 text-yellow-600",blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",orange:"bg-orange-100 text-orange-600",gold:"bg-yellow-100 text-yellow-600",indigo:"bg-indigo-100 text-indigo-600",red:"bg-red-100 text-red-600"}[a]||"bg-gray-100 text-gray-600"}`,children:e.jsx("i",{className:`${t.icon} text-lg`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-theme-text-primary "+(t.read?"":"font-bold"),children:t.title}),!t.read&&e.jsx("span",{className:"w-2 h-2 bg-brand-primary rounded-full flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("span",{className:"text-xs text-theme-text-tertiary whitespace-nowrap",children:b(t.timestamp)}),!t.read&&e.jsx("button",{onClick:()=>f(t.id),className:"text-brand-primary hover:text-brand-secondary transition-colors duration-200 p-1",title:"Mark as read",children:e.jsx("i",{className:"ri-check-line text-sm"})}),e.jsx("button",{onClick:()=>{return e=t.id,c(t=>t.filter(t=>t.id!==e)),void x(t=>t.filter(t=>t!==e));var e},className:"text-theme-text-tertiary hover:text-red-500 transition-colors duration-200 p-1",title:"Delete notification",children:e.jsx("i",{className:"ri-close-line text-sm"})})]})]}),e.jsx("p",{className:"text-theme-text-secondary mb-3 leading-relaxed",children:t.message}),t.actionText&&e.jsxs(s,{variant:"outline",onClick:()=>(e=>{e.actionUrl&&(e.read||f(e.id),l(e.actionUrl))})(t),className:"text-sm px-3 py-1.5 h-auto",children:[t.actionText,e.jsx("i",{className:"ri-arrow-right-line ml-1"})]})]})]})},t.id);var a})}),p.length>0&&p.length>=10&&e.jsx("div",{className:"text-center",children:e.jsxs(s,{variant:"outline",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Load More Notifications"]})})]})};export{l as default};
